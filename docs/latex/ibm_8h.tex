\hypertarget{ibm_8h}{}\doxysection{src/include/ibm.h File Reference}
\label{ibm_8h}\index{src/include/ibm.h@{src/include/ibm.h}}


IBM model header file.  


\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structVertex}{Vertex}}
\item 
struct \mbox{\hyperlink{structHalfEdge}{Half\+Edge}}
\item 
struct \mbox{\hyperlink{structFace}{Face}}
\item 
struct \mbox{\hyperlink{structibmNode}{ibm\+Node}}
\item 
struct \mbox{\hyperlink{structnode}{node}}
\begin{DoxyCompactList}\small\item\em Node struct. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structcellNode}{cell\+Node}}
\item 
struct \mbox{\hyperlink{structlist}{list}}
\begin{DoxyCompactList}\small\item\em Node list. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structcellList}{cell\+List}}
\begin{DoxyCompactList}\small\item\em cell Node list \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structsearchBox}{search\+Box}}
\item 
struct \mbox{\hyperlink{structibmMesh}{ibm\+Mesh}}
\item 
struct \mbox{\hyperlink{structibmRotation}{ibm\+Rotation}}
\item 
struct \mbox{\hyperlink{structibmSineMotion}{ibm\+Sine\+Motion}}
\item 
struct \mbox{\hyperlink{structibmPitchMotion}{ibm\+Pitch\+Motion}}
\item 
struct \mbox{\hyperlink{structsurface}{surface}}
\item 
struct \mbox{\hyperlink{structelementBox}{element\+Box}}
\item 
struct \mbox{\hyperlink{structibmObject}{ibm\+Object}}
\item 
struct \mbox{\hyperlink{structibmFluidCell}{ibm\+Fluid\+Cell}}
\item 
struct \mbox{\hyperlink{structibm__}{ibm\+\_\+}}
\begin{DoxyCompactList}\small\item\em struct storing IBM model \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ibm_8h_ae902ed3b2c2932c0dc63c4c6a45da99a}\label{ibm_8h_ae902ed3b2c2932c0dc63c4c6a45da99a}} 
\#define {\bfseries MAX\+\_\+\+ELEMENTS\+\_\+\+PER\+\_\+\+NODE}~20
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ibm_8h_a2e1662af5233d0fe6a6f061445d2ff25}\label{ibm_8h_a2e1662af5233d0fe6a6f061445d2ff25}} 
typedef struct \mbox{\hyperlink{structVertex}{Vertex}} {\bfseries Vertex}
\item 
\mbox{\Hypertarget{ibm_8h_a24691022259ce71b8f672ec4e3c14de4}\label{ibm_8h_a24691022259ce71b8f672ec4e3c14de4}} 
typedef struct \mbox{\hyperlink{structHalfEdge}{Half\+Edge}} {\bfseries Half\+Edge}
\item 
\mbox{\Hypertarget{ibm_8h_aeb6dbdfdd6ad7a52a99f4438f655e420}\label{ibm_8h_aeb6dbdfdd6ad7a52a99f4438f655e420}} 
typedef struct \mbox{\hyperlink{structFace}{Face}} {\bfseries Face}
\item 
\mbox{\Hypertarget{ibm_8h_af4aeda155dbe167f1c1cf38cb65bf324}\label{ibm_8h_af4aeda155dbe167f1c1cf38cb65bf324}} 
typedef struct \mbox{\hyperlink{structnode}{node}} \mbox{\hyperlink{ibm_8h_af4aeda155dbe167f1c1cf38cb65bf324}{node}}
\begin{DoxyCompactList}\small\item\em Node struct. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a6cc37f34de24d70d136131d11aea2bc9}\label{ibm_8h_a6cc37f34de24d70d136131d11aea2bc9}} 
typedef struct \mbox{\hyperlink{structcellNode}{cell\+Node}} {\bfseries cell\+Node}
\item 
\mbox{\Hypertarget{ibm_8h_aa295f649a192b2bcdc06effc2f71dde4}\label{ibm_8h_aa295f649a192b2bcdc06effc2f71dde4}} 
typedef struct \mbox{\hyperlink{structlist}{list}} \mbox{\hyperlink{ibm_8h_aa295f649a192b2bcdc06effc2f71dde4}{list}}
\begin{DoxyCompactList}\small\item\em Node list. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a0f9c85ad97be82365d4d3cd6cfe7fb19}\label{ibm_8h_a0f9c85ad97be82365d4d3cd6cfe7fb19}} 
typedef struct \mbox{\hyperlink{structcellList}{cell\+List}} \mbox{\hyperlink{ibm_8h_a0f9c85ad97be82365d4d3cd6cfe7fb19}{cell\+List}}
\begin{DoxyCompactList}\small\item\em cell Node list \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ibm_8h_a27dffc4d2f498f7dae7d9bd34594b2fd}\label{ibm_8h_a27dffc4d2f498f7dae7d9bd34594b2fd}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a27dffc4d2f498f7dae7d9bd34594b2fd}{Initialize\+IBM}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em initialize ibm\+: top level function \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a980ea403eaa390bd1d60a702c55e63fb}\label{ibm_8h_a980ea403eaa390bd1d60a702c55e63fb}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a980ea403eaa390bd1d60a702c55e63fb}{Update\+IBM}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em update imb\+: top level function \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a0a2a67029381cb8ac4691c1c5202db02}\label{ibm_8h_a0a2a67029381cb8ac4691c1c5202db02}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a0a2a67029381cb8ac4691c1c5202db02}{write\+IBMData}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm, Petsc\+Int b)
\begin{DoxyCompactList}\small\item\em writes the angular position when the body is rotating \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_ad6dcc4b2f715325743875a1c56e70918}\label{ibm_8h_ad6dcc4b2f715325743875a1c56e70918}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_ad6dcc4b2f715325743875a1c56e70918}{write\+IBMForce\+Data}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm, Petsc\+Int b, Petsc\+Real $\ast$g\+Elem\+Pressure, Petsc\+Real net\+Moment, Petsc\+Real ibm\+Power, \mbox{\hyperlink{structCmpnts}{Cmpnts}} Pres\+Force, \mbox{\hyperlink{structCmpnts}{Cmpnts}} Visc\+Force, \mbox{\hyperlink{structCmpnts}{Cmpnts}} moment\+Vector)
\begin{DoxyCompactList}\small\item\em writes the IBM force data for element and net force \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a9c978ae9d3e0e7fd31ca9be4b6503151}\label{ibm_8h_a9c978ae9d3e0e7fd31ca9be4b6503151}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a9c978ae9d3e0e7fd31ca9be4b6503151}{find\+IBMControlled\+Procs}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em find in which processors the ibm body belongs \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a3f671cb828aba8285c6e49b205ad2d21}\label{ibm_8h_a3f671cb828aba8285c6e49b205ad2d21}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a3f671cb828aba8285c6e49b205ad2d21}{init\+Element\+Projection\+Procs}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em create list of ibm element processors and their closest ibm fluid cell to the ibm element normal projection \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_ab5aee507680c3a7c2654d33a96830fdc}\label{ibm_8h_ab5aee507680c3a7c2654d33a96830fdc}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_ab5aee507680c3a7c2654d33a96830fdc}{IBMProjection\+Processor\+Transfer}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em transfer ibm mesh element across processors based on their movement -\/ for dynamic case \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a5b30173a04c821ef5d59917a8939976e}\label{ibm_8h_a5b30173a04c821ef5d59917a8939976e}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a5b30173a04c821ef5d59917a8939976e}{create\+Processor\+Buffer\+Zones}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em create inner and outer buffer zones for ibm mesh element parallelization \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a147ef292bbfee4ed4c8bc36bddee7e5c}\label{ibm_8h_a147ef292bbfee4ed4c8bc36bddee7e5c}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a147ef292bbfee4ed4c8bc36bddee7e5c}{init\+Element\+Procs}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em create list of ibm element processors and their closest ibm fluid cell to the ibm element \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a7bd12895748628f618047701a1545621}\label{ibm_8h_a7bd12895748628f618047701a1545621}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a7bd12895748628f618047701a1545621}{IBMElement\+Processor\+Transfer}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em transfer ibm mesh element across processors based on their movement -\/ for dynamic case \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_aef4d1a87a909b82473aeb921ab050402}\label{ibm_8h_aef4d1a87a909b82473aeb921ab050402}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_aef4d1a87a909b82473aeb921ab050402}{Update\+IBMesh}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em update the ibm mesh when the ibm body is moving \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_adbe8008b3b8d8e7ed3ab8053368a7752}\label{ibm_8h_adbe8008b3b8d8e7ed3ab8053368a7752}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_adbe8008b3b8d8e7ed3ab8053368a7752}{rotate\+IBMesh}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm, Petsc\+Int b)
\begin{DoxyCompactList}\small\item\em rotate the ibm mesh based on the angular speed input \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_ae6a4177abd8f8635d189aa420362b3a3}\label{ibm_8h_ae6a4177abd8f8635d189aa420362b3a3}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_ae6a4177abd8f8635d189aa420362b3a3}{sine\+Motion}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm, Petsc\+Int b)
\begin{DoxyCompactList}\small\item\em prescribe sinusoidal motion for IBM body \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a7a73bd79127407d432259afe801c58f2}\label{ibm_8h_a7a73bd79127407d432259afe801c58f2}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a7a73bd79127407d432259afe801c58f2}{pitching\+Motion}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm, Petsc\+Int b)
\begin{DoxyCompactList}\small\item\em prescribe pitching oscillation motion for IBM body \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a1f82afe6598ab4c9e337ace22dc64d03}\label{ibm_8h_a1f82afe6598ab4c9e337ace22dc64d03}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a1f82afe6598ab4c9e337ace22dc64d03}{set\+IBMWall\+Models}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em set IBM wall model type and properties \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a7b72f5a5ac4a157bbdc8393525100e4b}\label{ibm_8h_a7b72f5a5ac4a157bbdc8393525100e4b}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a7b72f5a5ac4a157bbdc8393525100e4b}{find\+Body\+Bounding\+Box}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em find the bounding box around an ibm body \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a7e7ffc1d9aadd2e8d20f621cdbd12219}\label{ibm_8h_a7e7ffc1d9aadd2e8d20f621cdbd12219}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a7e7ffc1d9aadd2e8d20f621cdbd12219}{find\+Search\+Cell\+Dim}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em find the search cell (coarser mesh around the ibm) dimension \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a22fe6d564940c2fa1ae407eab8a9d1c2}\label{ibm_8h_a22fe6d564940c2fa1ae407eab8a9d1c2}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a22fe6d564940c2fa1ae407eab8a9d1c2}{ibm\+Search}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em ibm fluid node search performed using ray tracing algorithm \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a5bc4cb3cf5176f6384e6e75a7fbfc891}\label{ibm_8h_a5bc4cb3cf5176f6384e6e75a7fbfc891}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a5bc4cb3cf5176f6384e6e75a7fbfc891}{find\+Closest\+IBMElement}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em find the closest ibm mesh element to a IBM fluid node \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a431ba70f0cfda3c4d73f4eb11c1af4cf}\label{ibm_8h_a431ba70f0cfda3c4d73f4eb11c1af4cf}} 
Petsc\+Error\+Code {\bfseries find\+Closest\+IBMElement2\+Solid} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\item 
\mbox{\Hypertarget{ibm_8h_ad9ff06f35bd8b87c5564386509d4abee}\label{ibm_8h_ad9ff06f35bd8b87c5564386509d4abee}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_ad9ff06f35bd8b87c5564386509d4abee}{find\+Interception\+Point}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em find the interception\+Point on the background mesh plane for curvib interpolation \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_ac02fe36932ca84186dab9ace8dbb8c69}\label{ibm_8h_ac02fe36932ca84186dab9ace8dbb8c69}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_ac02fe36932ca84186dab9ace8dbb8c69}{interception\+Pt}} (\mbox{\hyperlink{structCmpnts}{Cmpnts}} p\+Coor, \mbox{\hyperlink{structCmpnts}{Cmpnts}} pc\mbox{[}9\mbox{]}, \mbox{\hyperlink{structCmpnts}{Cmpnts}} e\+Norm, \mbox{\hyperlink{structibmFluidCell}{ibm\+Fluid\+Cell}} $\ast$ibF)
\begin{DoxyCompactList}\small\item\em interception point algorithm based on dividing the plane into 8 triangles \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a87fc7402b0753220ecb773fa936f9a40}\label{ibm_8h_a87fc7402b0753220ecb773fa936f9a40}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a87fc7402b0753220ecb773fa936f9a40}{find\+IBMFluid\+Cells}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em find list of ibm fluid nodes within each processor \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a90e60f76a23b242199ecc703b89e761d}\label{ibm_8h_a90e60f76a23b242199ecc703b89e761d}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a90e60f76a23b242199ecc703b89e761d}{find\+Fluid\+Support\+Nodes}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em find the fluid nodes that act as support nodes to the given ibm fluid node \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_affa113a10fce9e7aeea2efb4f0446902}\label{ibm_8h_affa113a10fce9e7aeea2efb4f0446902}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_affa113a10fce9e7aeea2efb4f0446902}{find\+IBMMesh\+Support\+Nodes}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em find the ibm mesh nodes that act as support node to the given ibm fluid node \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a30f648d428bc38794f33bd95e379f1be}\label{ibm_8h_a30f648d428bc38794f33bd95e379f1be}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a30f648d428bc38794f33bd95e379f1be}{MLSInterpolation}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em MLS interpolation algorithm. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a48ccba69df886b4d75ad9ab3c5c76545}\label{ibm_8h_a48ccba69df886b4d75ad9ab3c5c76545}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a48ccba69df886b4d75ad9ab3c5c76545}{Curvib\+Interpolation}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em CURVIB normal projection interpolation algorithm. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a90e956bb125c0f067ca9b1b9e290de67}\label{ibm_8h_a90e956bb125c0f067ca9b1b9e290de67}} 
Petsc\+Error\+Code {\bfseries Curvib\+Interpolation\+Triangular} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\item 
\mbox{\Hypertarget{ibm_8h_a0f3a01f0aa1e0e22879cceff82e5de03}\label{ibm_8h_a0f3a01f0aa1e0e22879cceff82e5de03}} 
Petsc\+Error\+Code {\bfseries Curvib\+Interpolation\+Quadratic} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\item 
\mbox{\Hypertarget{ibm_8h_a291b56ea50e202ba75e26aa573e63661}\label{ibm_8h_a291b56ea50e202ba75e26aa573e63661}} 
Petsc\+Error\+Code {\bfseries Curvib\+Interpolation\+Internal\+Cell} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\item 
\mbox{\Hypertarget{ibm_8h_a8b8405586e772390b404a0ecac7bdd47}\label{ibm_8h_a8b8405586e772390b404a0ecac7bdd47}} 
Petsc\+Error\+Code {\bfseries Compute\+Force\+Moment} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\item 
\mbox{\Hypertarget{ibm_8h_a14686f921852499d065420f312e5c25e}\label{ibm_8h_a14686f921852499d065420f312e5c25e}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a14686f921852499d065420f312e5c25e}{find\+IBMWall\+Shear}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em compute shear stress at faces close to the IBM \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a36736a607d2b97d7d25405b0effc6f89}\label{ibm_8h_a36736a607d2b97d7d25405b0effc6f89}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a36736a607d2b97d7d25405b0effc6f89}{find\+IBMWall\+Shear\+Chester}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em compute shear stress at faces close to the IBM \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a43e167a5b5b3d08f5ed3a50f4daaf25b}\label{ibm_8h_a43e167a5b5b3d08f5ed3a50f4daaf25b}} 
Petsc\+Error\+Code {\bfseries check\+IBMexists} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\item 
\mbox{\Hypertarget{ibm_8h_a89d7ff186ba17634484885a512f28d37}\label{ibm_8h_a89d7ff186ba17634484885a512f28d37}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_a89d7ff186ba17634484885a512f28d37}{create\+Search\+Cell\+List}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em insert ibm mesh elements as a list into the search cell that they belong to \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_ad9f008b01686202b1c82c4c3dd65ef69}\label{ibm_8h_ad9f008b01686202b1c82c4c3dd65ef69}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_ad9f008b01686202b1c82c4c3dd65ef69}{destroy\+Lists}} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\begin{DoxyCompactList}\small\item\em destroy the ibm search cell list \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_afc2703ea43352d8178d04365f27b95b0}\label{ibm_8h_afc2703ea43352d8178d04365f27b95b0}} 
Petsc\+Error\+Code {\bfseries compute\+IBMElement\+Normal} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\item 
\mbox{\Hypertarget{ibm_8h_ae63380960668316fc9f40c9166dea41f}\label{ibm_8h_ae63380960668316fc9f40c9166dea41f}} 
Petsc\+Error\+Code {\bfseries recompute\+IBMesh\+Properties} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm, Petsc\+Int b)
\item 
\mbox{\Hypertarget{ibm_8h_ae1b491cac2919062950d708521cbe45b}\label{ibm_8h_ae1b491cac2919062950d708521cbe45b}} 
Petsc\+Error\+Code {\bfseries create\+Half\+Edge\+Data\+Structure} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\item 
\mbox{\Hypertarget{ibm_8h_a55eb0e0052299cf764dad8c71ae873a8}\label{ibm_8h_a55eb0e0052299cf764dad8c71ae873a8}} 
Petsc\+Real \mbox{\hyperlink{ibm_8h_a55eb0e0052299cf764dad8c71ae873a8}{ray\+Casting\+Test}} (\mbox{\hyperlink{structCmpnts}{Cmpnts}} p, \mbox{\hyperlink{structibmMesh}{ibm\+Mesh}} $\ast$ib\+Msh, \mbox{\hyperlink{structcellIds}{cell\+Ids}} s\+Cell, \mbox{\hyperlink{structsearchBox}{search\+Box}} $\ast$s\+Box, \mbox{\hyperlink{structboundingBox}{bounding\+Box}} $\ast$ib\+Box, \mbox{\hyperlink{structlist}{list}} $\ast$search\+Cell\+List)
\begin{DoxyCompactList}\small\item\em ray casting algorithm \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_ad5498c3f877d30b55e996929a281daa3}\label{ibm_8h_ad5498c3f877d30b55e996929a281daa3}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_ad5498c3f877d30b55e996929a281daa3}{ray\+Cast\+Local}} (\mbox{\hyperlink{structCmpnts}{Cmpnts}} p, \mbox{\hyperlink{structCmpnts}{Cmpnts}} p1, \mbox{\hyperlink{structCmpnts}{Cmpnts}} p2, \mbox{\hyperlink{structCmpnts}{Cmpnts}} p3, \mbox{\hyperlink{structCmpnts}{Cmpnts}} p4, \mbox{\hyperlink{structibmMesh}{ibm\+Mesh}} $\ast$ib\+Msh, \mbox{\hyperlink{structcellIds}{cell\+Ids}} s\+Cell, \mbox{\hyperlink{structsearchBox}{search\+Box}} $\ast$s\+Box, \mbox{\hyperlink{structboundingBox}{bounding\+Box}} $\ast$ib\+Box, \mbox{\hyperlink{structlist}{list}} $\ast$search\+Cell\+List, Petsc\+Int \&intersect)
\begin{DoxyCompactList}\small\item\em ray casting algorithm in local positive cell neighbourhood \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_accba6ab47e789e78f8c65a3acfd8785a}\label{ibm_8h_accba6ab47e789e78f8c65a3acfd8785a}} 
Petsc\+Error\+Code \mbox{\hyperlink{ibm_8h_accba6ab47e789e78f8c65a3acfd8785a}{element\+Bounding\+Sphere}} (\mbox{\hyperlink{structibmObject}{ibm\+Object}} $\ast$ibm\+Body)
\begin{DoxyCompactList}\small\item\em find element bounding sphere \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a1efbf48eda7859feed3fc0ac3d1a05ef}\label{ibm_8h_a1efbf48eda7859feed3fc0ac3d1a05ef}} 
\mbox{\hyperlink{structCmpnts}{Cmpnts}} \mbox{\hyperlink{ibm_8h_a1efbf48eda7859feed3fc0ac3d1a05ef}{randomdirection}} (\mbox{\hyperlink{structCmpnts}{Cmpnts}} p, \mbox{\hyperlink{structcellIds}{cell\+Ids}} s\+Cell, \mbox{\hyperlink{structboundingBox}{bounding\+Box}} $\ast$ib\+Box, \mbox{\hyperlink{structsearchBox}{search\+Box}} $\ast$s\+Box, Petsc\+Int seed)
\begin{DoxyCompactList}\small\item\em inline function to generate a random direction along the z index of the search cell for the ray casting algorithm \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a225ea650c1f5e0a6e89fbe1e5b9c9ca6}\label{ibm_8h_a225ea650c1f5e0a6e89fbe1e5b9c9ca6}} 
Petsc\+Int \mbox{\hyperlink{ibm_8h_a225ea650c1f5e0a6e89fbe1e5b9c9ca6}{intsect\+Element}} (\mbox{\hyperlink{structCmpnts}{Cmpnts}} p, \mbox{\hyperlink{structCmpnts}{Cmpnts}} dir, \mbox{\hyperlink{structCmpnts}{Cmpnts}} node1, \mbox{\hyperlink{structCmpnts}{Cmpnts}} node2, \mbox{\hyperlink{structCmpnts}{Cmpnts}} node3, Petsc\+Real $\ast$t, Petsc\+Real $\ast$u, Petsc\+Real $\ast$v)
\begin{DoxyCompactList}\small\item\em inline function to check if the ray intersects an ibm element \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a4163457cd2faa612b882432264758b98}\label{ibm_8h_a4163457cd2faa612b882432264758b98}} 
Petsc\+Bool \mbox{\hyperlink{ibm_8h_a4163457cd2faa612b882432264758b98}{is\+Line\+Triangle\+Int}} (\mbox{\hyperlink{structCmpnts}{Cmpnts}} p1, \mbox{\hyperlink{structCmpnts}{Cmpnts}} p2, \mbox{\hyperlink{structibmMesh}{ibm\+Mesh}} $\ast$ib\+Msh, Petsc\+Int e)
\begin{DoxyCompactList}\small\item\em inline function to check if the line intersects an ibm element \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_aa665ba7f2d24a676e56ba9f026ac9cfd}\label{ibm_8h_aa665ba7f2d24a676e56ba9f026ac9cfd}} 
bool \mbox{\hyperlink{ibm_8h_aa665ba7f2d24a676e56ba9f026ac9cfd}{is\+Search\+Cell\+Support}} (Petsc\+Real rad, \mbox{\hyperlink{structCmpnts}{Cmpnts}} pt, \mbox{\hyperlink{structcellIds}{cell\+Ids}} c\+ID, \mbox{\hyperlink{structboundingBox}{bounding\+Box}} $\ast$ib\+Box, \mbox{\hyperlink{structsearchBox}{search\+Box}} $\ast$s\+Box)
\begin{DoxyCompactList}\small\item\em inline function to check if a search cell is a support to an ibm fluid node \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a0fabc589698fb5e266287a1d9a9a968b}\label{ibm_8h_a0fabc589698fb5e266287a1d9a9a968b}} 
void \mbox{\hyperlink{ibm_8h_a0fabc589698fb5e266287a1d9a9a968b}{insert\+IBMSupport\+Nodes}} (\mbox{\hyperlink{structCmpnts}{Cmpnts}} pt, \mbox{\hyperlink{structcellIds}{cell\+Ids}} s\+Cell, \mbox{\hyperlink{structibmFluidCell}{ibm\+Fluid\+Cell}} $\ast$ibF, \mbox{\hyperlink{structibmObject}{ibm\+Object}} $\ast$ib\+Body, \mbox{\hyperlink{structsearchBox}{search\+Box}} $\ast$s\+Box)
\begin{DoxyCompactList}\small\item\em insert ibm nodes into the list of support nodes around an ibm fluid node \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_aa7076cdb89c42f86b92221e477af8e1a}\label{ibm_8h_aa7076cdb89c42f86b92221e477af8e1a}} 
Petsc\+Int \mbox{\hyperlink{ibm_8h_aa7076cdb89c42f86b92221e477af8e1a}{ISSame\+Side2D}} (\mbox{\hyperlink{structCpt2D}{Cpt2D}} p, \mbox{\hyperlink{structCpt2D}{Cpt2D}} p1, \mbox{\hyperlink{structCpt2D}{Cpt2D}} p2, \mbox{\hyperlink{structCpt2D}{Cpt2D}} p3)
\begin{DoxyCompactList}\small\item\em Check whether 2D point p is located on the same side of line p1p2. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a65a12b9220bf4d302a8067fd742f0673}\label{ibm_8h_a65a12b9220bf4d302a8067fd742f0673}} 
Petsc\+Int \mbox{\hyperlink{ibm_8h_a65a12b9220bf4d302a8067fd742f0673}{ISInside\+Triangle2D}} (\mbox{\hyperlink{structCpt2D}{Cpt2D}} p, \mbox{\hyperlink{structCpt2D}{Cpt2D}} pa, \mbox{\hyperlink{structCpt2D}{Cpt2D}} pb, \mbox{\hyperlink{structCpt2D}{Cpt2D}} pc)
\begin{DoxyCompactList}\small\item\em check whether point p is inside the triangle -\/ 2D \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a61ee5019514dd4f8a95db6ec38e1adf1}\label{ibm_8h_a61ee5019514dd4f8a95db6ec38e1adf1}} 
Petsc\+Int \mbox{\hyperlink{ibm_8h_a61ee5019514dd4f8a95db6ec38e1adf1}{is\+Point\+In\+Triangle}} (\mbox{\hyperlink{structCmpnts}{Cmpnts}} p, \mbox{\hyperlink{structCmpnts}{Cmpnts}} p1, \mbox{\hyperlink{structCmpnts}{Cmpnts}} p2, \mbox{\hyperlink{structCmpnts}{Cmpnts}} p3, \mbox{\hyperlink{structCmpnts}{Cmpnts}} norm)
\begin{DoxyCompactList}\small\item\em check whether point p is inside the triangle -\/ 3D \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_af2c3cd09846085e044d9cbfd68ccd45d}\label{ibm_8h_af2c3cd09846085e044d9cbfd68ccd45d}} 
\mbox{\hyperlink{structCmpnts}{Cmpnts}} \mbox{\hyperlink{ibm_8h_af2c3cd09846085e044d9cbfd68ccd45d}{compute\+Vertex\+Average\+Normal}} (\mbox{\hyperlink{structibmMesh}{ibm\+Mesh}} $\ast$ib\+Msh, Petsc\+Int vertex\+Id)
\begin{DoxyCompactList}\small\item\em find the angle averaged normal about a vertex \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_ac46b83e6523b38245489661412419262}\label{ibm_8h_ac46b83e6523b38245489661412419262}} 
\mbox{\hyperlink{structCmpnts}{Cmpnts}} \mbox{\hyperlink{ibm_8h_ac46b83e6523b38245489661412419262}{compute\+Edge\+Average\+Normal}} (\mbox{\hyperlink{structibmMesh}{ibm\+Mesh}} $\ast$ib\+Msh, Petsc\+Int vertex\+Id, Petsc\+Int face\+Id)
\begin{DoxyCompactList}\small\item\em find the angle averaged normal about an edge \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a55ac4fe2c634c3e1079b2ddad3032350}\label{ibm_8h_a55ac4fe2c634c3e1079b2ddad3032350}} 
void \mbox{\hyperlink{ibm_8h_a55ac4fe2c634c3e1079b2ddad3032350}{dis\+P2\+Line}} (\mbox{\hyperlink{structCmpnts}{Cmpnts}} p, \mbox{\hyperlink{structCmpnts}{Cmpnts}} p1, \mbox{\hyperlink{structCmpnts}{Cmpnts}} p2, \mbox{\hyperlink{structCmpnts}{Cmpnts}} $\ast$po, Petsc\+Real $\ast$d, Petsc\+Real $\ast$t)
\begin{DoxyCompactList}\small\item\em find projection of point on a line and the distance to it \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_ac82c224251e6d94f1bc3d415db2ad928}\label{ibm_8h_ac82c224251e6d94f1bc3d415db2ad928}} 
void \mbox{\hyperlink{ibm_8h_ac82c224251e6d94f1bc3d415db2ad928}{triangle\+Intp}} (\mbox{\hyperlink{structCpt2D}{Cpt2D}} p, \mbox{\hyperlink{structCpt2D}{Cpt2D}} p1, \mbox{\hyperlink{structCpt2D}{Cpt2D}} p2, \mbox{\hyperlink{structCpt2D}{Cpt2D}} p3, \mbox{\hyperlink{structibmFluidCell}{ibm\+Fluid\+Cell}} $\ast$ibF)
\begin{DoxyCompactList}\small\item\em find the interpolation weights of a point inside a triangle from its nodes \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ibm_8h_a40cbf5311141e00bf27379fd85a748be}\label{ibm_8h_a40cbf5311141e00bf27379fd85a748be}} 
void \mbox{\hyperlink{ibm_8h_a40cbf5311141e00bf27379fd85a748be}{triangle\+Intp\+Bg}} (\mbox{\hyperlink{structCpt2D}{Cpt2D}} p, \mbox{\hyperlink{structCpt2D}{Cpt2D}} p1, \mbox{\hyperlink{structCpt2D}{Cpt2D}} p2, \mbox{\hyperlink{structCpt2D}{Cpt2D}} p3, \mbox{\hyperlink{structibmFluidCell}{ibm\+Fluid\+Cell}} $\ast$ibF)
\begin{DoxyCompactList}\small\item\em find the interpolation weights of a point inside a triangle from its nodes used for background grid \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
IBM model header file. 

IBM input header file.