\hypertarget{peqn_8h}{}\doxysection{src/include/peqn.h File Reference}
\label{peqn_8h}\index{src/include/peqn.h@{src/include/peqn.h}}


P equation solution header file.  


\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structpeqn__}{peqn\+\_\+}}
\begin{DoxyCompactList}\small\item\em struct storing pressure equation \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{peqn_8h_a8ee26f27490cd2ba1ba573baeee692ba}\label{peqn_8h_a8ee26f27490cd2ba1ba573baeee692ba}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a8ee26f27490cd2ba1ba573baeee692ba}{Initialize\+PEqn}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Initializes Peqn environment. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_af2c443594a2304edf96ff8e4e7db4c66}\label{peqn_8h_af2c443594a2304edf96ff8e4e7db4c66}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_af2c443594a2304edf96ff8e4e7db4c66}{Create\+Hypre\+Solver}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Initializes HYPRE solver. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a3b7b44d6eb7ed52d6759ce0e88e32753}\label{peqn_8h_a3b7b44d6eb7ed52d6759ce0e88e32753}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a3b7b44d6eb7ed52d6759ce0e88e32753}{Create\+PETSc\+Solver}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Initializes PETSc solver. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_ad9fa6dfb07b806bdc343704f04083eff}\label{peqn_8h_ad9fa6dfb07b806bdc343704f04083eff}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_ad9fa6dfb07b806bdc343704f04083eff}{Create\+Hypre\+Matrix}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Initializes HYPRE matrix. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a9b80e75909222e5cbf70669ee5855ac2}\label{peqn_8h_a9b80e75909222e5cbf70669ee5855ac2}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a9b80e75909222e5cbf70669ee5855ac2}{Create\+PETSc\+Matrix}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Initializes PETSc matrix. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_adda9d62eee9605356dc72fef0a33edb8}\label{peqn_8h_adda9d62eee9605356dc72fef0a33edb8}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_adda9d62eee9605356dc72fef0a33edb8}{Create\+Hypre\+Vector}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Initializes HYPRE vector. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_adf12103284db07a2ec2b7cbaa5801665}\label{peqn_8h_adf12103284db07a2ec2b7cbaa5801665}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_adf12103284db07a2ec2b7cbaa5801665}{Create\+PETSc\+Vector}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Initializes PETSc vector. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a7b109d01b7be010b26e0c9a50b6c16da}\label{peqn_8h_a7b109d01b7be010b26e0c9a50b6c16da}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a7b109d01b7be010b26e0c9a50b6c16da}{Destroy\+Hypre\+Solver}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Destroys HYPRE solver. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a32fce59bf9f488f323e994d3137472df}\label{peqn_8h_a32fce59bf9f488f323e994d3137472df}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a32fce59bf9f488f323e994d3137472df}{Destroy\+PETSc\+Solver}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Destroys PETSc solver. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_aea4bbdf561dfb67d150e7c1b69dd38a5}\label{peqn_8h_aea4bbdf561dfb67d150e7c1b69dd38a5}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_aea4bbdf561dfb67d150e7c1b69dd38a5}{Destroy\+Hypre\+Matrix}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Destroys HYPRE matrix. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_ad1b0d4c628f840fed6b01cff1b049415}\label{peqn_8h_ad1b0d4c628f840fed6b01cff1b049415}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_ad1b0d4c628f840fed6b01cff1b049415}{Destroy\+Hypre\+Vector}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Destroys HYPRE vector. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a696ae83da96a02ecd4cd7b0322ec5b07}\label{peqn_8h_a696ae83da96a02ecd4cd7b0322ec5b07}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a696ae83da96a02ecd4cd7b0322ec5b07}{Destroy\+PETSc\+Vector}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Destroys PETSc vector. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_ad083be97b70c8defdb8741cb277b2bf7}\label{peqn_8h_ad083be97b70c8defdb8741cb277b2bf7}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_ad083be97b70c8defdb8741cb277b2bf7}{Petsc2\+Hypre\+Vector}} (Vec \&A, HYPRE\+\_\+\+IJVector \&B, HYPRE\+\_\+\+Int start\+ID)
\begin{DoxyCompactList}\small\item\em Transfer vector values from Petsc 2 Hypre. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a11c3504237006df917b0e61e159f5807}\label{peqn_8h_a11c3504237006df917b0e61e159f5807}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a11c3504237006df917b0e61e159f5807}{Hypre2\+Petsc\+Vector}} (HYPRE\+\_\+\+IJVector \&B, Vec \&A, HYPRE\+\_\+\+Int start\+ID)
\begin{DoxyCompactList}\small\item\em Transfer vector values from Hypre 2 Petsc. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a9846cb49857f2528a8146f6e6ccd0e9b}\label{peqn_8h_a9846cb49857f2528a8146f6e6ccd0e9b}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a9846cb49857f2528a8146f6e6ccd0e9b}{phi\+To\+Phi}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Convert phi to Phi (1D to 3D vector) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_ad70bea1744fa4be27bffab83f74e350b}\label{peqn_8h_ad70bea1744fa4be27bffab83f74e350b}} 
Petsc\+Real \mbox{\hyperlink{peqn_8h_ad70bea1744fa4be27bffab83f74e350b}{L2\+Norm\+Hypre}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn, HYPRE\+\_\+\+IJMatrix \&A, HYPRE\+\_\+\+IJVector \&X, HYPRE\+\_\+\+IJVector \&B)
\begin{DoxyCompactList}\small\item\em Compute L2 norm of system residual. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_ad87194cd8a026e6581fd4ab72f0e931a}\label{peqn_8h_ad87194cd8a026e6581fd4ab72f0e931a}} 
Petsc\+Real \mbox{\hyperlink{peqn_8h_ad87194cd8a026e6581fd4ab72f0e931a}{L2\+Norm\+PETSc}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn, Mat \&A, Vec \&X, Vec \&B)
\begin{DoxyCompactList}\small\item\em Compute L2 norm of system residual. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_ab7768de2161a2bbe0ffbcbe4782694eb}\label{peqn_8h_ab7768de2161a2bbe0ffbcbe4782694eb}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_ab7768de2161a2bbe0ffbcbe4782694eb}{GradP}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Compute pressure gradient term. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a9231ed77659514a09ab5f246e8b35af7}\label{peqn_8h_a9231ed77659514a09ab5f246e8b35af7}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a9231ed77659514a09ab5f246e8b35af7}{Set\+Poisson\+Connectivity}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Compute cell-\/matrix connectivity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a9daf3d053c5f54a60930d2c3fb41c4e9}\label{peqn_8h_a9daf3d053c5f54a60930d2c3fb41c4e9}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a9daf3d053c5f54a60930d2c3fb41c4e9}{Set\+Coeff\+Matrix}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Compute coefficient matrix. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_af35cf556e36d7002ea71ccc59c6119c7}\label{peqn_8h_af35cf556e36d7002ea71ccc59c6119c7}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_af35cf556e36d7002ea71ccc59c6119c7}{Zero\+Coeff\+Matrix}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Zeroes coefficient matrix. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a47ceea848fc387454697a64956cc467a}\label{peqn_8h_a47ceea848fc387454697a64956cc467a}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a47ceea848fc387454697a64956cc467a}{Set\+RHS}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Set RHS of the pressure equation. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_afb43101b11e04a4a9a2ef81e057d521f}\label{peqn_8h_afb43101b11e04a4a9a2ef81e057d521f}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_afb43101b11e04a4a9a2ef81e057d521f}{Subtract\+Average\+Hypre}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn, HYPRE\+\_\+\+IJVector \&B)
\begin{DoxyCompactList}\small\item\em Subtract average from the solution. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a9d5a40e9824682720a1696eb9cc1a9d2}\label{peqn_8h_a9d5a40e9824682720a1696eb9cc1a9d2}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a9d5a40e9824682720a1696eb9cc1a9d2}{Subtract\+Average\+PETSc}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn, Vec \&B)
\begin{DoxyCompactList}\small\item\em Subtract average from the solution. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a28d43afc0244d005d1c81d5a297408b0}\label{peqn_8h_a28d43afc0244d005d1c81d5a297408b0}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a28d43afc0244d005d1c81d5a297408b0}{Adjust\+IBMFlux}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Correct IBM volume flux. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_ad3c83c05b82fba196345bd68cb408341}\label{peqn_8h_ad3c83c05b82fba196345bd68cb408341}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_ad3c83c05b82fba196345bd68cb408341}{Update\+Pressure}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Update pressure and subtract average. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a3a5e3c8695659e00b4749eea28f638e8}\label{peqn_8h_a3a5e3c8695659e00b4749eea28f638e8}} 
Petsc\+Error\+Code {\bfseries update\+IBMPhi} (\mbox{\hyperlink{structibm__}{ibm\+\_\+}} $\ast$ibm)
\item 
\mbox{\Hypertarget{peqn_8h_a7a65ba9c5e62bcfc9be56370f4bcbc0c}\label{peqn_8h_a7a65ba9c5e62bcfc9be56370f4bcbc0c}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a7a65ba9c5e62bcfc9be56370f4bcbc0c}{Project\+Velocity}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Project Ucont into an incompressible space. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a653e735ef518ba7324fad4c577eddb37}\label{peqn_8h_a653e735ef518ba7324fad4c577eddb37}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a653e735ef518ba7324fad4c577eddb37}{Solve\+PEqn}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Compute pressure gradient term. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_af5bf345a51d99fa844f6f4104491eb1e}\label{peqn_8h_af5bf345a51d99fa844f6f4104491eb1e}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_af5bf345a51d99fa844f6f4104491eb1e}{Set\+Pressure\+Reference}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Set pressure = 0 at k = 0, j = 0, i = 0. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a9d397554e586163d7f6df8d76d1efe5e}\label{peqn_8h_a9d397554e586163d7f6df8d76d1efe5e}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a9d397554e586163d7f6df8d76d1efe5e}{Continuity\+Errors}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Compute continuity errors (also calculates which cell and processor has the max) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a6d6e47782ac1420eec4354c28f140f8b}\label{peqn_8h_a6d6e47782ac1420eec4354c28f140f8b}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a6d6e47782ac1420eec4354c28f140f8b}{Continuity\+Errors\+Optimized}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Compute continuity errors (only prints the max) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_a922ff40ebdb5c5775c2a05a4edb11a2a}\label{peqn_8h_a922ff40ebdb5c5775c2a05a4edb11a2a}} 
Petsc\+Error\+Code \mbox{\hyperlink{peqn_8h_a922ff40ebdb5c5775c2a05a4edb11a2a}{Init\+Gravity\+Wave\+Induced\+Pressure}} (\mbox{\hyperlink{structpeqn__}{peqn\+\_\+}} $\ast$peqn)
\begin{DoxyCompactList}\small\item\em Initialize pressure with given gravity wave large-\/scale pressure field from 3LM. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{peqn_8h_ac45612683608b3102a801b9117098d34}\label{peqn_8h_ac45612683608b3102a801b9117098d34}} 
\mbox{\hyperlink{structcellIds}{cell\+Ids}} \mbox{\hyperlink{peqn_8h_ac45612683608b3102a801b9117098d34}{Get\+Id\+From\+Stencil}} (int stencil, int k, int j, int i)
\begin{DoxyCompactList}\small\item\em get the cell id from stencil position \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
P equation solution header file. 

