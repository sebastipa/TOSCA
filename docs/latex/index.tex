Toolbox f\+Or Stratified Convective Atmospheres\hypertarget{index_autotoc_md0}{}\doxysection{Executables}\label{index_autotoc_md0}
\begin{DoxyVerb}- tosca    : transient solver for stratified incompressible flows. Temperature stratification is accounted via Boussinesq approximation.
- windToPW : post processor for ParaView visualization. Writes data in XMF/HDF format.
\end{DoxyVerb}
\hypertarget{index_autotoc_md1}{}\doxysection{Boundary Conditions}\label{index_autotoc_md1}
\begin{DoxyVerb}- noSlip               : on all patches
- slip                 : on all patches
- zeroGradient         : on all patches
- fixedGradient        : on all patches (only T equation)
- inflowFunction       : only on kLeft patch. Different types of inflow can be prescribed: ABL inflow using teorethical laws, mapped inflow from a precursor
                         simulation that can be also periodized and/or interpolated if meshes are not consistent.
- velocityWallFunction : shear stress model (only U equation). Can be prescribed on jRight and jLeft patches
- thetaWallFunction    : potential temperature wall model (only T equation). Can be prescribed on jRight and jLeft patches
\end{DoxyVerb}
\hypertarget{index_autotoc_md2}{}\doxysection{Wall Models}\label{index_autotoc_md2}
\begin{DoxyVerb}- Shumann    : applies wall shear stress in the momentum equation according to similarity theory of Paulson and Obuhkov.
               Velocity BC is dependent (velocityWallFunction/thetaWallFunction, type -3).
- Cabot      : prescribes velocity BC according to Cabot formulation (velocityWallFunction, type -1).
\end{DoxyVerb}
\hypertarget{index_autotoc_md3}{}\doxysection{Turbulence Models}\label{index_autotoc_md3}
\begin{DoxyVerb}- Smagorinsky standard model (les 1).
- Dynamic Smagorinsky LES turbulence model with cubic (les 3) or lagrangian (les 4) averaging.
\end{DoxyVerb}
\hypertarget{index_autotoc_md4}{}\doxysection{Turbine Models}\label{index_autotoc_md4}
\begin{DoxyVerb}- UADM : base actuator disk model with imposed Ct and yaw controller
- ADM  : advanced actuator disk model with rotor dynamics and yaw/pitch/rotation controllers
- UADM : base actuator disk model with uniform disk loading and yaw controller
- AFM  : anisotropic actuator farm model for coarser meshes, integral/point sampling available
\end{DoxyVerb}
\hypertarget{index_autotoc_md5}{}\doxysection{I\+B\+M Method}\label{index_autotoc_md5}
\begin{DoxyVerb}TOSCA uses a sharp-interface IBM method with ghost cells applied on the flow side of the body. This allows for more flexibility with
thin bodies but complicated wall modeling. New wall models have been recently added, validated with both hi-Re terrains (Shumann) or small objects (Cabot).
Moving IBM is also possible, we are currently validating the latter capability.
\end{DoxyVerb}
\hypertarget{index_autotoc_md6}{}\doxysection{Acquisition System}\label{index_autotoc_md6}
\begin{DoxyVerb}- ABL wall-parallel planes-averaged statistics as a function of time
- field averages
- domain sections
- probes with advanced parallel I/O writing
- turbine data with advanced parallel I/O writing
- ABL perturbations w.r.t. reference state
- layer averaged fields (three layers available - 3LM)
- mechanical energy budgets within user-defined boxes (the code is not energy-conservative so MKE eq. is not fullfilled)
\end{DoxyVerb}
\hypertarget{index_autotoc_md7}{}\doxysection{Future Implementations\+:}\label{index_autotoc_md7}
\begin{DoxyVerb}- Overset with fringe interpolation
- IBM smooth normals and thin-body augmented search
\end{DoxyVerb}
\hypertarget{index_autotoc_md8}{}\doxysection{Notes\+:}\label{index_autotoc_md8}
\begin{DoxyVerb}- test cases which contain an empty 'inflowDatabase' file require the inflow database. A sample database can be downloaded
  at https://drive.google.com/file/d/17F5wtI5Jc1XGh8crmOVJYVXabC8iQXq1/view?usp=sharing, simply substitute the 'inflowDatabase'
  file with the downloaded folder.
\end{DoxyVerb}
\hypertarget{index_autotoc_md9}{}\doxysection{Installation\+:}\label{index_autotoc_md9}
In order to be installed, T\+O\+S\+CA requires a working C/\+C++ compiler, P\+E\+T\+Sc (version 3.\+14.\+x, 3.\+15.\+x), Open M\+PI (version 4.\+0.\+x, 4.\+1.\+x), H\+D\+F5 and H\+Y\+P\+RE (needed by P\+E\+T\+Ss in order to build some of the matrix solvers we use). T\+O\+S\+CA has been tested with the above version combinations, it could work with other combinations or versions but it has not been tested (especially older versions). We recommend the following versions of the above libraries\+:
\begin{DoxyItemize}
\item gcc \+: 9.\+2.\+0 (\href{https://gcc.gnu.org/}{\texttt{ https\+://gcc.\+gnu.\+org/}}).
\item P\+E\+T\+Sc \+: 3.\+15.\+5 (\href{https://ftp.mcs.anl.gov/pub/petsc/}{\texttt{ https\+://ftp.\+mcs.\+anl.\+gov/pub/petsc/}}).
\item Open M\+PI \+: 4.\+1.\+2 (\href{https://www.open-mpi.org/software/ompi/v4.1/}{\texttt{ https\+://www.\+open-\/mpi.\+org/software/ompi/v4.\+1/}}).
\item H\+Y\+P\+RE \+: 2.\+20.\+0 (\href{https://github.com/hypre-space/hypre/tree/hypre_petsc}{\texttt{ https\+://github.\+com/hypre-\/space/hypre/tree/hypre\+\_\+petsc}}) (check version in /src/\+C\+Make\+Lists.txt).
\item H\+D\+F5 \+: 1.\+12.\+1 (\href{https://www.hdfgroup.org/downloads/hdf5/}{\texttt{ https\+://www.\+hdfgroup.\+org/downloads/hdf5/}}).
\end{DoxyItemize}

Prior to install T\+O\+S\+CA, we suggest to create a folder named {\ttfamily Software} inside {\ttfamily \$\+H\+O\+ME}, where the P\+E\+T\+Sc, H\+Y\+P\+RE and T\+O\+S\+CA folders will be located. In order to compile T\+O\+S\+CA on your system, please follow these steps\+:


\begin{DoxyItemize}
\item Check your compiler version with {\ttfamily gcc -\/-\/version}
\item Download P\+E\+T\+Sc into {\ttfamily \$\+H\+O\+ME/\+Software/}
\item Download H\+Y\+P\+RE {\ttfamily \$\+H\+O\+ME/\+Software/}
\item Download Open M\+PI\+: you can download the binaries or compile from source (the latter is recommended if use {\ttfamily environment-\/modules}). If you have only one version of Open M\+PI installed on your system in the {\ttfamily /usr} directory (using sudo for example), you can omit the `-\/-\/with-\/mpi-\/dir=\textquotesingle{}your-\/-\/path-\/-\/to-\/-\/mpicc'` at point 4\+: Open M\+PI will be found by the \textquotesingle{}ld' library locator.
\item Configure P\+E\+T\+Sc (will automatically compile H\+Y\+P\+RE). We suggest the following configure options\+: `./configure -\/-\/with-\/fc=0 -\/-\/download-\/f2cblaslapack -\/-\/with-\/mpi-\/dir=\textquotesingle{}your-\/-\/path-\/-\/to-\/-\/mpicc' --download-\/hypre=\textquotesingle{}your--path--to--hypre \textbackslash{} --with-\/64-\/bit-\/indices=1 --with-\/debugging=0\`{}
\item Make P\+E\+T\+Sc with {\ttfamily make all}
\item Test P\+E\+T\+Sc with {\ttfamily make check}
\item Save an environment variable that will tell T\+O\+S\+CA where P\+E\+T\+Sc is installed in your .bashrc\+: {\ttfamily echo \char`\"{}export P\+E\+T\+S\+C\+\_\+\+D\+I\+R=\$\+H\+O\+M\+E/your-\/-\/path-\/-\/to-\/-\/petsc\char`\"{} $>$$>$ \$\+H\+O\+ME/.bashrc}
\item Save an environment variable that will tell T\+O\+S\+CA which P\+E\+T\+Sc architecture is required in your .bashrc. Note\+: this is the folder within \$\+P\+E\+T\+S\+C\+\_\+\+D\+IR with a name beginning with \char`\"{}arch-\/\char`\"{}. In a typical installation, it will be \char`\"{}arch-\/linux-\/c-\/opt\char`\"{}\+: {\ttfamily echo \char`\"{}export P\+E\+T\+S\+C\+\_\+\+A\+R\+C\+H=arch-\/linux-\/c-\/opt\char`\"{} $>$$>$ \$\+H\+O\+ME/.bashrc}
\item Add the P\+E\+T\+Sc shared libraries to your library path environment variable in your .bashrc\+: {\ttfamily echo \char`\"{}export L\+D\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+P\+A\+T\+H=\$\+L\+D\+\_\+\+L\+I\+B\+R\+A\+R\+Y\+\_\+\+P\+A\+T\+H\+:\$\+P\+E\+T\+S\+C\+\_\+\+D\+I\+R/\$\+P\+E\+T\+S\+C\+\_\+\+A\+R\+C\+H/lib\char`\"{} $>$$>$ \$\+H\+O\+ME/.bashrc}
\item Reload the environment with {\ttfamily source \$\+H\+O\+ME/.bashrc}
\item Go inside T\+O\+S\+C\+A/src directory and compile the executables with {\ttfamily make tosca} and {\ttfamily make wind\+To\+PW}
\item Test the installation by copying {\ttfamily tosca} and {\ttfamily wind\+To\+PW} in one of the example cases and run the simulation and the post-\/processing with {\ttfamily ./tosca} and {\ttfamily ./wind\+To\+PW} respectively. To run in parallel you have to use `mpirun -\/np \textquotesingle{}your-\/number-\/of-\/processors' ./tosca\`{}
\end{DoxyItemize}

Credits and Copyright\+: Sebastiano Stipa -\/ Arjun Ajay -\/ Mohammad Hadi -\/ The University of British Columbia 