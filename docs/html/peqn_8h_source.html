<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TOSCA: src/include/peqn.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TOSCA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b0856f6b0d80ccb263b2f415c91f9e17.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">peqn.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="peqn_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#ifndef _PEQN_H_</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#define _PEQN_H_</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="structpeqn__.html">    8</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structpeqn__.html">peqn_</a></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="structpeqn__.html#a464e3871213f7bbd7c6397229ddd4b72">   10</a></span>&#160;    Vec           <a class="code" href="structpeqn__.html#a464e3871213f7bbd7c6397229ddd4b72">phi</a>;                        </div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="structpeqn__.html#a3041e494b4877608c16e42858130e588">   11</a></span>&#160;    Vec           Phi, <a class="code" href="structpeqn__.html#a3041e494b4877608c16e42858130e588">lPhi</a>;                  </div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="structpeqn__.html#ae03567ba774ad5648c97ba71d8e5e39a">   12</a></span>&#160;    Vec           P, <a class="code" href="structpeqn__.html#ae03567ba774ad5648c97ba71d8e5e39a">lP</a>;                      </div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="structpeqn__.html#a436bdf22d65e240fbeb6c8132d8496fe">   13</a></span>&#160;    Vec           lLid, <a class="code" href="structpeqn__.html#a436bdf22d65e240fbeb6c8132d8496fe">lGid</a>;                 </div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="structpeqn__.html#abe37423a45dd3b55533fa5535fabf3cf">   14</a></span>&#160;    HYPRE_Int     <a class="code" href="structpeqn__.html#abe37423a45dd3b55533fa5535fabf3cf">thisRankSize</a>,               </div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="structpeqn__.html#a71ed9b6869aaab82858c19f58aa98fd8">   15</a></span>&#160;                  <a class="code" href="structpeqn__.html#a71ed9b6869aaab82858c19f58aa98fd8">thisRankStart</a>,              </div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="structpeqn__.html#a4377b381ee9e36c4d95d8370c13c85fb">   16</a></span>&#160;                  <a class="code" href="structpeqn__.html#a4377b381ee9e36c4d95d8370c13c85fb">thisRankEnd</a>;                </div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="structpeqn__.html#a9b5031c8bbf3dad751ed7b0ea184b1d5">   17</a></span>&#160;    HYPRE_Int     <a class="code" href="structpeqn__.html#a9b5031c8bbf3dad751ed7b0ea184b1d5">totalSize</a>;                  </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    PetscReal        initialPoissonRes,</div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="structpeqn__.html#a0f8e48e07bea85c145ce481786e0a164">   19</a></span>&#160;                  <a class="code" href="structpeqn__.html#a0f8e48e07bea85c145ce481786e0a164">finalPoissonRes</a>;            </div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="structpeqn__.html#ac04ddc4e5b2ab8242202152be103c09e">   20</a></span>&#160;    HYPRE_Int     <a class="code" href="structpeqn__.html#ac04ddc4e5b2ab8242202152be103c09e">poissonIterations</a>;          </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="structpeqn__.html#a5cb00c57c0efa9f1453bc379482b4034">   22</a></span>&#160;    PetscInt      <a class="code" href="structpeqn__.html#a5cb00c57c0efa9f1453bc379482b4034">hypreSolverType</a>;            </div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="structpeqn__.html#a8662b1a3d930bfb4e9e6e15a31c29103">   23</a></span>&#160;    PetscInt      <a class="code" href="structpeqn__.html#a8662b1a3d930bfb4e9e6e15a31c29103">poissonIt</a>;                  </div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="structpeqn__.html#a0d18e3c14740cd099b098037099ec8c7">   24</a></span>&#160;    PetscReal        <a class="code" href="structpeqn__.html#a0d18e3c14740cd099b098037099ec8c7">poissonTol</a>;                 </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">// solver parameters</span></div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="structpeqn__.html#aeddffe6c08ced60368000883509a4fd7">   27</a></span>&#160;    PetscInt      <a class="code" href="structpeqn__.html#aeddffe6c08ced60368000883509a4fd7">amgAgg</a>;                     </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    PetscInt      amgCoarsenType;</div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structpeqn__.html#ae4976c76128ace97e66e27b08e9d00c4">   29</a></span>&#160;    PetscReal        <a class="code" href="structpeqn__.html#ae4976c76128ace97e66e27b08e9d00c4">amgThresh</a>;                  </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// hypre solver</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="structpeqn__.html#aebb38c0ddc4039f9d48fe9465003659a">   32</a></span>&#160;    HYPRE_Solver       <a class="code" href="structpeqn__.html#aebb38c0ddc4039f9d48fe9465003659a">hypreSlvr</a>;             </div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structpeqn__.html#a0366eaa89b291a549cf3454d9e3e83db">   33</a></span>&#160;    HYPRE_Solver       <a class="code" href="structpeqn__.html#a0366eaa89b291a549cf3454d9e3e83db">PC</a>;                    </div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="structpeqn__.html#af9c73b7c6d5eff1fd3ef3ea2250608b5">   34</a></span>&#160;    HYPRE_IJMatrix     <a class="code" href="structpeqn__.html#af9c73b7c6d5eff1fd3ef3ea2250608b5">hypreA</a>;                </div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structpeqn__.html#ad1f20406c27a0b2adfe0766e37c725ee">   35</a></span>&#160;    HYPRE_ParCSRMatrix <a class="code" href="structpeqn__.html#ad1f20406c27a0b2adfe0766e37c725ee">hypreParA</a>;             </div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structpeqn__.html#a55410b97ee3ed160a2eead648efd680b">   36</a></span>&#160;    HYPRE_IJVector     hypreP, <a class="code" href="structpeqn__.html#a55410b97ee3ed160a2eead648efd680b">hypreRhs</a>;      </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structpeqn__.html#a024231cde6b2227e5ffee8555bc2f949">   37</a></span>&#160;    HYPRE_ParVector    hypreParP, <a class="code" href="structpeqn__.html#a024231cde6b2227e5ffee8555bc2f949">hypreParRhs</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// access</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structpeqn__.html#ac7013e14356e7d0d43cb48fe2847b772">   40</a></span>&#160;    <a class="code" href="structaccess__.html">access_</a>            *<a class="code" href="structpeqn__.html#ac7013e14356e7d0d43cb48fe2847b772">access</a>;                 </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;};</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a8ee26f27490cd2ba1ba573baeee692ba">InitializePEqn</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#af2c443594a2304edf96ff8e4e7db4c66">CreateHypreSolver</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#ad9fa6dfb07b806bdc343704f04083eff">CreateHypreMatrix</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#adda9d62eee9605356dc72fef0a33edb8">CreateHypreVector</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a7b109d01b7be010b26e0c9a50b6c16da">DestroyHypreSolver</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#aea4bbdf561dfb67d150e7c1b69dd38a5">DestroyHypreMatrix</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#ad1b0d4c628f840fed6b01cff1b049415">DestroyHypreVector</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#ad083be97b70c8defdb8741cb277b2bf7">Petsc2HypreVector</a>(Vec &amp;A, HYPRE_IJVector &amp;B, HYPRE_Int startID);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a11c3504237006df917b0e61e159f5807">Hypre2PetscVector</a>(HYPRE_IJVector &amp;B, Vec &amp;A, HYPRE_Int startID);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a9846cb49857f2528a8146f6e6ccd0e9b">phiToPhi</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;PetscReal         <a class="code" href="peqn_8h.html#ad70bea1744fa4be27bffab83f74e350b">L2NormHypre</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn, HYPRE_IJMatrix &amp;A, HYPRE_IJVector &amp;X, HYPRE_IJVector &amp;B);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#ab7768de2161a2bbe0ffbcbe4782694eb">GradP</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a9231ed77659514a09ab5f246e8b35af7">SetPoissonConnectivity</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a9daf3d053c5f54a60930d2c3fb41c4e9">SetCoeffMatrix</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#af35cf556e36d7002ea71ccc59c6119c7">ZeroCoeffMatrix</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a47ceea848fc387454697a64956cc467a">SetRHS</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#abeea8cb5145898128043685604fce837">SubtractAverage</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn, HYPRE_IJVector &amp;B);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a28d43afc0244d005d1c81d5a297408b0">AdjustIBMFlux</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#ad3c83c05b82fba196345bd68cb408341">UpdatePressure</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a7a65ba9c5e62bcfc9be56370f4bcbc0c">ProjectVelocity</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a653e735ef518ba7324fad4c577eddb37">SolvePEqn</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;PetscErrorCode <a class="code" href="peqn_8h.html#a9d397554e586163d7f6df8d76d1efe5e">ContinuityErrors</a>(<a class="code" href="structpeqn__.html">peqn_</a> *peqn);</div>
<div class="ttc" id="apeqn_8h_html_a11c3504237006df917b0e61e159f5807"><div class="ttname"><a href="peqn_8h.html#a11c3504237006df917b0e61e159f5807">Hypre2PetscVector</a></div><div class="ttdeci">PetscErrorCode Hypre2PetscVector(HYPRE_IJVector &amp;B, Vec &amp;A, HYPRE_Int startID)</div><div class="ttdoc">Transfer vector values from Hypre 2 Petsc.</div><div class="ttdef"><b>Definition:</b> peqn.c:1564</div></div>
<div class="ttc" id="apeqn_8h_html_a28d43afc0244d005d1c81d5a297408b0"><div class="ttname"><a href="peqn_8h.html#a28d43afc0244d005d1c81d5a297408b0">AdjustIBMFlux</a></div><div class="ttdeci">PetscErrorCode AdjustIBMFlux(peqn_ *peqn)</div><div class="ttdoc">Correct IBM volume flux.</div><div class="ttdef"><b>Definition:</b> peqn.c:1993</div></div>
<div class="ttc" id="apeqn_8h_html_a47ceea848fc387454697a64956cc467a"><div class="ttname"><a href="peqn_8h.html#a47ceea848fc387454697a64956cc467a">SetRHS</a></div><div class="ttdeci">PetscErrorCode SetRHS(peqn_ *peqn)</div><div class="ttdoc">Set RHS of the pressure equation.</div><div class="ttdef"><b>Definition:</b> peqn.c:1874</div></div>
<div class="ttc" id="apeqn_8h_html_a653e735ef518ba7324fad4c577eddb37"><div class="ttname"><a href="peqn_8h.html#a653e735ef518ba7324fad4c577eddb37">SolvePEqn</a></div><div class="ttdeci">PetscErrorCode SolvePEqn(peqn_ *peqn)</div><div class="ttdoc">Compute pressure gradient term.</div><div class="ttdef"><b>Definition:</b> peqn.c:3236</div></div>
<div class="ttc" id="apeqn_8h_html_a7a65ba9c5e62bcfc9be56370f4bcbc0c"><div class="ttname"><a href="peqn_8h.html#a7a65ba9c5e62bcfc9be56370f4bcbc0c">ProjectVelocity</a></div><div class="ttdeci">PetscErrorCode ProjectVelocity(peqn_ *peqn)</div><div class="ttdoc">Project Ucont into an incompressible space.</div><div class="ttdef"><b>Definition:</b> peqn.c:2353</div></div>
<div class="ttc" id="apeqn_8h_html_a7b109d01b7be010b26e0c9a50b6c16da"><div class="ttname"><a href="peqn_8h.html#a7b109d01b7be010b26e0c9a50b6c16da">DestroyHypreSolver</a></div><div class="ttdeci">PetscErrorCode DestroyHypreSolver(peqn_ *peqn)</div><div class="ttdoc">Destroys HYPRE solver.</div><div class="ttdef"><b>Definition:</b> peqn.c:449</div></div>
<div class="ttc" id="apeqn_8h_html_a8ee26f27490cd2ba1ba573baeee692ba"><div class="ttname"><a href="peqn_8h.html#a8ee26f27490cd2ba1ba573baeee692ba">InitializePEqn</a></div><div class="ttdeci">PetscErrorCode InitializePEqn(peqn_ *peqn)</div><div class="ttdoc">Initializes Peqn environment.</div><div class="ttdef"><b>Definition:</b> peqn.c:35</div></div>
<div class="ttc" id="apeqn_8h_html_a9231ed77659514a09ab5f246e8b35af7"><div class="ttname"><a href="peqn_8h.html#a9231ed77659514a09ab5f246e8b35af7">SetPoissonConnectivity</a></div><div class="ttdeci">PetscErrorCode SetPoissonConnectivity(peqn_ *peqn)</div><div class="ttdoc">Compute cell-matrix connectivity.</div><div class="ttdef"><b>Definition:</b> peqn.c:82</div></div>
<div class="ttc" id="apeqn_8h_html_a9846cb49857f2528a8146f6e6ccd0e9b"><div class="ttname"><a href="peqn_8h.html#a9846cb49857f2528a8146f6e6ccd0e9b">phiToPhi</a></div><div class="ttdeci">PetscErrorCode phiToPhi(peqn_ *peqn)</div><div class="ttdoc">Convert phi to Phi (1D to 3D vector)</div><div class="ttdef"><b>Definition:</b> peqn.c:1603</div></div>
<div class="ttc" id="apeqn_8h_html_a9d397554e586163d7f6df8d76d1efe5e"><div class="ttname"><a href="peqn_8h.html#a9d397554e586163d7f6df8d76d1efe5e">ContinuityErrors</a></div><div class="ttdeci">PetscErrorCode ContinuityErrors(peqn_ *peqn)</div><div class="ttdoc">Compute continuity errors.</div><div class="ttdef"><b>Definition:</b> peqn.c:3380</div></div>
<div class="ttc" id="apeqn_8h_html_a9daf3d053c5f54a60930d2c3fb41c4e9"><div class="ttname"><a href="peqn_8h.html#a9daf3d053c5f54a60930d2c3fb41c4e9">SetCoeffMatrix</a></div><div class="ttdeci">PetscErrorCode SetCoeffMatrix(peqn_ *peqn)</div><div class="ttdoc">Compute coefficient matrix.</div><div class="ttdef"><b>Definition:</b> peqn.c:470</div></div>
<div class="ttc" id="apeqn_8h_html_ab7768de2161a2bbe0ffbcbe4782694eb"><div class="ttname"><a href="peqn_8h.html#ab7768de2161a2bbe0ffbcbe4782694eb">GradP</a></div><div class="ttdeci">PetscErrorCode GradP(peqn_ *peqn)</div><div class="ttdoc">Compute pressure gradient term.</div><div class="ttdef"><b>Definition:</b> peqn.c:2890</div></div>
<div class="ttc" id="apeqn_8h_html_abeea8cb5145898128043685604fce837"><div class="ttname"><a href="peqn_8h.html#abeea8cb5145898128043685604fce837">SubtractAverage</a></div><div class="ttdeci">PetscErrorCode SubtractAverage(peqn_ *peqn, HYPRE_IJVector &amp;B)</div><div class="ttdoc">Subtract average from the solution.</div><div class="ttdef"><b>Definition:</b> peqn.c:1792</div></div>
<div class="ttc" id="apeqn_8h_html_ad083be97b70c8defdb8741cb277b2bf7"><div class="ttname"><a href="peqn_8h.html#ad083be97b70c8defdb8741cb277b2bf7">Petsc2HypreVector</a></div><div class="ttdeci">PetscErrorCode Petsc2HypreVector(Vec &amp;A, HYPRE_IJVector &amp;B, HYPRE_Int startID)</div><div class="ttdoc">Transfer vector values from Petsc 2 Hypre.</div><div class="ttdef"><b>Definition:</b> peqn.c:1529</div></div>
<div class="ttc" id="apeqn_8h_html_ad1b0d4c628f840fed6b01cff1b049415"><div class="ttname"><a href="peqn_8h.html#ad1b0d4c628f840fed6b01cff1b049415">DestroyHypreVector</a></div><div class="ttdeci">PetscErrorCode DestroyHypreVector(peqn_ *peqn)</div><div class="ttdoc">Destroys HYPRE vector.</div><div class="ttdef"><b>Definition:</b> peqn.c:439</div></div>
<div class="ttc" id="apeqn_8h_html_ad3c83c05b82fba196345bd68cb408341"><div class="ttname"><a href="peqn_8h.html#ad3c83c05b82fba196345bd68cb408341">UpdatePressure</a></div><div class="ttdeci">PetscErrorCode UpdatePressure(peqn_ *peqn)</div><div class="ttdoc">Update pressure and subtract average.</div><div class="ttdef"><b>Definition:</b> peqn.c:2806</div></div>
<div class="ttc" id="apeqn_8h_html_ad70bea1744fa4be27bffab83f74e350b"><div class="ttname"><a href="peqn_8h.html#ad70bea1744fa4be27bffab83f74e350b">L2NormHypre</a></div><div class="ttdeci">PetscReal L2NormHypre(peqn_ *peqn, HYPRE_IJMatrix &amp;A, HYPRE_IJVector &amp;X, HYPRE_IJVector &amp;B)</div><div class="ttdoc">Compute L2 norm of system residual.</div><div class="ttdef"><b>Definition:</b> peqn.c:1664</div></div>
<div class="ttc" id="apeqn_8h_html_ad9fa6dfb07b806bdc343704f04083eff"><div class="ttname"><a href="peqn_8h.html#ad9fa6dfb07b806bdc343704f04083eff">CreateHypreMatrix</a></div><div class="ttdeci">PetscErrorCode CreateHypreMatrix(peqn_ *peqn)</div><div class="ttdoc">Initializes HYPRE matrix.</div><div class="ttdef"><b>Definition:</b> peqn.c:289</div></div>
<div class="ttc" id="apeqn_8h_html_adda9d62eee9605356dc72fef0a33edb8"><div class="ttname"><a href="peqn_8h.html#adda9d62eee9605356dc72fef0a33edb8">CreateHypreVector</a></div><div class="ttdeci">PetscErrorCode CreateHypreVector(peqn_ *peqn)</div><div class="ttdoc">Initializes HYPRE vector.</div><div class="ttdef"><b>Definition:</b> peqn.c:334</div></div>
<div class="ttc" id="apeqn_8h_html_aea4bbdf561dfb67d150e7c1b69dd38a5"><div class="ttname"><a href="peqn_8h.html#aea4bbdf561dfb67d150e7c1b69dd38a5">DestroyHypreMatrix</a></div><div class="ttdeci">PetscErrorCode DestroyHypreMatrix(peqn_ *peqn)</div><div class="ttdoc">Destroys HYPRE matrix.</div><div class="ttdef"><b>Definition:</b> peqn.c:430</div></div>
<div class="ttc" id="apeqn_8h_html_af2c443594a2304edf96ff8e4e7db4c66"><div class="ttname"><a href="peqn_8h.html#af2c443594a2304edf96ff8e4e7db4c66">CreateHypreSolver</a></div><div class="ttdeci">PetscErrorCode CreateHypreSolver(peqn_ *peqn)</div><div class="ttdoc">Initializes HYPRE solver.</div><div class="ttdef"><b>Definition:</b> peqn.c:354</div></div>
<div class="ttc" id="apeqn_8h_html_af35cf556e36d7002ea71ccc59c6119c7"><div class="ttname"><a href="peqn_8h.html#af35cf556e36d7002ea71ccc59c6119c7">ZeroCoeffMatrix</a></div><div class="ttdeci">PetscErrorCode ZeroCoeffMatrix(peqn_ *peqn)</div><div class="ttdoc">Set coefficient matrix to zero.</div><div class="ttdef"><b>Definition:</b> peqn.c:1433</div></div>
<div class="ttc" id="astructaccess___html"><div class="ttname"><a href="structaccess__.html">access_</a></div><div class="ttdoc">access database</div><div class="ttdef"><b>Definition:</b> access.h:9</div></div>
<div class="ttc" id="astructpeqn___html"><div class="ttname"><a href="structpeqn__.html">peqn_</a></div><div class="ttdoc">struct storing pressure equation</div><div class="ttdef"><b>Definition:</b> peqn.h:9</div></div>
<div class="ttc" id="astructpeqn___html_a024231cde6b2227e5ffee8555bc2f949"><div class="ttname"><a href="structpeqn__.html#a024231cde6b2227e5ffee8555bc2f949">peqn_::hypreParRhs</a></div><div class="ttdeci">HYPRE_ParVector hypreParRhs</div><div class="ttdoc">unknown and RHS</div><div class="ttdef"><b>Definition:</b> peqn.h:37</div></div>
<div class="ttc" id="astructpeqn___html_a0366eaa89b291a549cf3454d9e3e83db"><div class="ttname"><a href="structpeqn__.html#a0366eaa89b291a549cf3454d9e3e83db">peqn_::PC</a></div><div class="ttdeci">HYPRE_Solver PC</div><div class="ttdoc">preconditioner</div><div class="ttdef"><b>Definition:</b> peqn.h:33</div></div>
<div class="ttc" id="astructpeqn___html_a0d18e3c14740cd099b098037099ec8c7"><div class="ttname"><a href="structpeqn__.html#a0d18e3c14740cd099b098037099ec8c7">peqn_::poissonTol</a></div><div class="ttdeci">PetscReal poissonTol</div><div class="ttdoc">relative exit tolerance</div><div class="ttdef"><b>Definition:</b> peqn.h:24</div></div>
<div class="ttc" id="astructpeqn___html_a0f8e48e07bea85c145ce481786e0a164"><div class="ttname"><a href="structpeqn__.html#a0f8e48e07bea85c145ce481786e0a164">peqn_::finalPoissonRes</a></div><div class="ttdeci">PetscReal finalPoissonRes</div><div class="ttdoc">initial and final residual of the Poisson iteration</div><div class="ttdef"><b>Definition:</b> peqn.h:19</div></div>
<div class="ttc" id="astructpeqn___html_a3041e494b4877608c16e42858130e588"><div class="ttname"><a href="structpeqn__.html#a3041e494b4877608c16e42858130e588">peqn_::lPhi</a></div><div class="ttdeci">Vec lPhi</div><div class="ttdoc">pressure correction for frac. step method</div><div class="ttdef"><b>Definition:</b> peqn.h:11</div></div>
<div class="ttc" id="astructpeqn___html_a436bdf22d65e240fbeb6c8132d8496fe"><div class="ttname"><a href="structpeqn__.html#a436bdf22d65e240fbeb6c8132d8496fe">peqn_::lGid</a></div><div class="ttdeci">Vec lGid</div><div class="ttdoc">matrixFree - matrixBased connectivity (used to build the poisson coeff. matrix)</div><div class="ttdef"><b>Definition:</b> peqn.h:13</div></div>
<div class="ttc" id="astructpeqn___html_a4377b381ee9e36c4d95d8370c13c85fb"><div class="ttname"><a href="structpeqn__.html#a4377b381ee9e36c4d95d8370c13c85fb">peqn_::thisRankEnd</a></div><div class="ttdeci">HYPRE_Int thisRankEnd</div><div class="ttdoc">last cell ID owned by this processor in global indexing (thisRankStart + thisRankSize - 1)</div><div class="ttdef"><b>Definition:</b> peqn.h:16</div></div>
<div class="ttc" id="astructpeqn___html_a464e3871213f7bbd7c6397229ddd4b72"><div class="ttname"><a href="structpeqn__.html#a464e3871213f7bbd7c6397229ddd4b72">peqn_::phi</a></div><div class="ttdeci">Vec phi</div><div class="ttdoc">phi is the actual solution of Poisson equation (then converted in Phi)</div><div class="ttdef"><b>Definition:</b> peqn.h:10</div></div>
<div class="ttc" id="astructpeqn___html_a55410b97ee3ed160a2eead648efd680b"><div class="ttname"><a href="structpeqn__.html#a55410b97ee3ed160a2eead648efd680b">peqn_::hypreRhs</a></div><div class="ttdeci">HYPRE_IJVector hypreRhs</div><div class="ttdoc">unknwon and RHS</div><div class="ttdef"><b>Definition:</b> peqn.h:36</div></div>
<div class="ttc" id="astructpeqn___html_a5cb00c57c0efa9f1453bc379482b4034"><div class="ttname"><a href="structpeqn__.html#a5cb00c57c0efa9f1453bc379482b4034">peqn_::hypreSolverType</a></div><div class="ttdeci">PetscInt hypreSolverType</div><div class="ttdoc">1: GMRES, 2: PCG</div><div class="ttdef"><b>Definition:</b> peqn.h:22</div></div>
<div class="ttc" id="astructpeqn___html_a71ed9b6869aaab82858c19f58aa98fd8"><div class="ttname"><a href="structpeqn__.html#a71ed9b6869aaab82858c19f58aa98fd8">peqn_::thisRankStart</a></div><div class="ttdeci">HYPRE_Int thisRankStart</div><div class="ttdoc">first cell ID owned by this processor in global indexing (used to build the poisson coeff....</div><div class="ttdef"><b>Definition:</b> peqn.h:15</div></div>
<div class="ttc" id="astructpeqn___html_a8662b1a3d930bfb4e9e6e15a31c29103"><div class="ttname"><a href="structpeqn__.html#a8662b1a3d930bfb4e9e6e15a31c29103">peqn_::poissonIt</a></div><div class="ttdeci">PetscInt poissonIt</div><div class="ttdoc">max number of poisson iterations per timestep</div><div class="ttdef"><b>Definition:</b> peqn.h:23</div></div>
<div class="ttc" id="astructpeqn___html_a9b5031c8bbf3dad751ed7b0ea184b1d5"><div class="ttname"><a href="structpeqn__.html#a9b5031c8bbf3dad751ed7b0ea184b1d5">peqn_::totalSize</a></div><div class="ttdeci">HYPRE_Int totalSize</div><div class="ttdoc">total number of cells (excluding physical ghost &amp; IBM points, depending of the Hypre Poisson type,...</div><div class="ttdef"><b>Definition:</b> peqn.h:17</div></div>
<div class="ttc" id="astructpeqn___html_abe37423a45dd3b55533fa5535fabf3cf"><div class="ttname"><a href="structpeqn__.html#abe37423a45dd3b55533fa5535fabf3cf">peqn_::thisRankSize</a></div><div class="ttdeci">HYPRE_Int thisRankSize</div><div class="ttdoc">number of cells owned by this processore (used to build the poisson coeff. matrix)</div><div class="ttdef"><b>Definition:</b> peqn.h:14</div></div>
<div class="ttc" id="astructpeqn___html_ac04ddc4e5b2ab8242202152be103c09e"><div class="ttname"><a href="structpeqn__.html#ac04ddc4e5b2ab8242202152be103c09e">peqn_::poissonIterations</a></div><div class="ttdeci">HYPRE_Int poissonIterations</div><div class="ttdoc">number of Poisson iterations</div><div class="ttdef"><b>Definition:</b> peqn.h:20</div></div>
<div class="ttc" id="astructpeqn___html_ac7013e14356e7d0d43cb48fe2847b772"><div class="ttname"><a href="structpeqn__.html#ac7013e14356e7d0d43cb48fe2847b772">peqn_::access</a></div><div class="ttdeci">access_ * access</div><div class="ttdoc">access database</div><div class="ttdef"><b>Definition:</b> peqn.h:40</div></div>
<div class="ttc" id="astructpeqn___html_ad1f20406c27a0b2adfe0766e37c725ee"><div class="ttname"><a href="structpeqn__.html#ad1f20406c27a0b2adfe0766e37c725ee">peqn_::hypreParA</a></div><div class="ttdeci">HYPRE_ParCSRMatrix hypreParA</div><div class="ttdoc">coefficient matrix</div><div class="ttdef"><b>Definition:</b> peqn.h:35</div></div>
<div class="ttc" id="astructpeqn___html_ae03567ba774ad5648c97ba71d8e5e39a"><div class="ttname"><a href="structpeqn__.html#ae03567ba774ad5648c97ba71d8e5e39a">peqn_::lP</a></div><div class="ttdeci">Vec lP</div><div class="ttdoc">pressure at current and previous time step</div><div class="ttdef"><b>Definition:</b> peqn.h:12</div></div>
<div class="ttc" id="astructpeqn___html_ae4976c76128ace97e66e27b08e9d00c4"><div class="ttname"><a href="structpeqn__.html#ae4976c76128ace97e66e27b08e9d00c4">peqn_::amgThresh</a></div><div class="ttdeci">PetscReal amgThresh</div><div class="ttdoc">threshold value - 0.5 : Cartesian, 0.6 : Distorted</div><div class="ttdef"><b>Definition:</b> peqn.h:29</div></div>
<div class="ttc" id="astructpeqn___html_aebb38c0ddc4039f9d48fe9465003659a"><div class="ttname"><a href="structpeqn__.html#aebb38c0ddc4039f9d48fe9465003659a">peqn_::hypreSlvr</a></div><div class="ttdeci">HYPRE_Solver hypreSlvr</div><div class="ttdoc">solver</div><div class="ttdef"><b>Definition:</b> peqn.h:32</div></div>
<div class="ttc" id="astructpeqn___html_aeddffe6c08ced60368000883509a4fd7"><div class="ttname"><a href="structpeqn__.html#aeddffe6c08ced60368000883509a4fd7">peqn_::amgAgg</a></div><div class="ttdeci">PetscInt amgAgg</div><div class="ttdoc">aggresive coarsening is good for &gt; 50mil grids</div><div class="ttdef"><b>Definition:</b> peqn.h:27</div></div>
<div class="ttc" id="astructpeqn___html_af9c73b7c6d5eff1fd3ef3ea2250608b5"><div class="ttname"><a href="structpeqn__.html#af9c73b7c6d5eff1fd3ef3ea2250608b5">peqn_::hypreA</a></div><div class="ttdeci">HYPRE_IJMatrix hypreA</div><div class="ttdoc">coefficient matrix</div><div class="ttdef"><b>Definition:</b> peqn.h:34</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
