

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Guide &mdash; TOSCA 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=23c79765" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Theory Guide" href="tosca_theory_guide.html" />
    <link rel="prev" title="Getting Started" href="tosca_quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            TOSCA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tosca_setup.html">TOSCA Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tosca_setup.html#contribute-to-the-tosca-project">Contribute to the TOSCA Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="tosca_setup.html#paraview-catalyst2-os-rendering">Paraview-Catalyst2 OS-Rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="tosca_quickstart.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input-files">Input Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#control-dat"><cite>control.dat</cite></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#time-controls">Time Controls</a></li>
<li class="toctree-l4"><a class="reference internal" href="#i-o-controls">I/O Controls</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solution-flags">Solution Flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solution-controls">Solution Controls</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solution-constants">Solution Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acquisition-controls">Acquisition Controls</a></li>
<li class="toctree-l4"><a class="reference internal" href="#post-processing-controls">Post Processing Controls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#boundary"><cite>boundary</cite></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#boundary-conditions">Boundary Conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wall-functions">Wall Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inlet-functions">Inlet Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initial-condition">Initial Condition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ablproperties-dat"><cite>ABLProperties.dat</cite></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#controllerproperties">controllerProperties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xdampingproperties">xDampingProperties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ydampingproperties">yDampingProperties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#zdampingproperties">zDampingProperties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#advectiondampingproperties">advectionDampingProperties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kleftdampingproperties">kLeftDampingProperties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#krightdampingproperties">kRightDampingProperties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#canopyproperties">canopyProperties</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#turbines"><cite>turbines</cite></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#spatial-mesh">Spatial Mesh</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tosca_theory_guide.html">Theory Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tosca_examples.html">Example Cases</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TOSCA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">User Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tosca_user_guide.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="user-guide">
<h1>User Guide<a class="headerlink" href="#user-guide" title="Link to this heading"></a></h1>
<p>TOSCA uses ASCII input files, organized in files and dictionaries.
The code provides some level of input checking, meaning that non-recognized inputs are followed by an error message that
lists available possibilities.</p>
<p>TOSCA has a standardized case structure. The minimum-required case structure is depicted on the right of the following figure,
while the case structure required to run e.g. atmospheric boundary layer (ABL) and wind farm simulations with potential
temperature stratification is shown on the right (i.e. with the addition of the <code class="docutils literal notranslate"><span class="pre">boundary/T</span></code> and <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> files).
The principal control file for a TOSCA simulation is the <cite>control.dat</cite> file, located in the case directory (see
<a class="reference internal" href="#control-subsection"><span class="std std-ref">control.dat</span></a> for details).
Depending on the type of simulation that one wishes to perform, flags can be activated in the <cite>control.dat</cite>, which prompt TOSCA
to read additional input files and data. These are described in Sec. <a class="reference internal" href="#input-files-section"><span class="std std-ref">Input Files</span></a>.</p>
<img alt="_images/structure_1.png" class="align-center" src="_images/structure_1.png" />
<p>Within TOSCA, specific entry types are defined, which are used to define boundary conditions as well as other inputs throughout the code. These are</p>
<ol class="arabic simple">
<li><p><em>bool</em>       : an integer which is 0 (false) or 1 (true)</p></li>
<li><p><em>integer</em>    : an integer number</p></li>
<li><p><em>scalar</em>     : a floating point number (if an integer is provided, this is cast into a floating point number).</p></li>
<li><p><em>vector</em>     : a group of floating point numbers defined as <em>(scalar scalar scalar)</em>, where the scalar <strong>must</strong> be a floating point number. There shouldn’t be any space between parantheses and the first and last vector components.</p></li>
<li><p><em>string</em>     : a word without spaces.</p></li>
<li><p><em>dictionary</em> : a group of additional entries, where the number is dependant on the name of the dictionary, embodied within <cite>{}</cite> parentheses. Dictionaries can containmultiple integer, bool, scalar, vector and string entries. An example is given below.</p></li>
</ol>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">dictionary</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">boolEntry</span><span class="w">    </span><span class="mi">1</span>
<span class="w">   </span><span class="n">integerEntry</span><span class="w"> </span><span class="mi">10</span>
<span class="w">   </span><span class="n">scalarEntry</span><span class="w">  </span><span class="mf">1.0</span><span class="w"> </span><span class="c1">// or 1</span>
<span class="w">   </span><span class="n">vectorEntry</span><span class="w">  </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span>
<span class="w">   </span><span class="n">stringEntry</span><span class="w">  </span><span class="n">someRandomString</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Inside the <code class="docutils literal notranslate"><span class="pre">boundary</span></code> directory, initial and boundary conditions are set in files having the same name as the field they
describe (see <a class="reference internal" href="#boundary-subsection"><span class="std std-ref">boundary</span></a> for details).</p>
<section id="input-files">
<span id="input-files-section"></span><h2>Input Files<a class="headerlink" href="#input-files" title="Link to this heading"></a></h2>
<p>This section describes TOSCA’s input files and their available entries.</p>
<section id="control-dat">
<span id="control-subsection"></span><h3><cite>control.dat</cite><a class="headerlink" href="#control-dat" title="Link to this heading"></a></h3>
<p>As already mentioned, TOSCA expects a specific case structure, where the <cite>control.dat</cite> file contains the main simulation settings,
some of which prompt the code to read additional input files. The <cite>control.dat</cite> is subdivided in 7 subsections, namely</p>
<ol class="arabic simple">
<li><p>Time Controls</p></li>
<li><p>I/O Controls</p></li>
<li><p>Solution Flags</p></li>
<li><p>Solution Controls</p></li>
<li><p>Solution Constants</p></li>
<li><p>Acquisition Controls</p></li>
<li><p>Post Processing Controls</p></li>
</ol>
<p>The last group is only needed when the <code class="docutils literal notranslate"><span class="pre">tosca2PV</span></code> executable is launched, which converts the binary TOSCA output in <code class="docutils literal notranslate"><span class="pre">.xmf</span></code>
format, which can be read from e.g. <cite>ParaView</cite>. The following tables summarize all available entries for each of the <cite>control.dat</cite>
file subsections.</p>
<section id="time-controls">
<h4>Time Controls<a class="headerlink" href="#time-controls" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 65.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-startFrom</span></code></p></td>
<td><p>It can be set to <cite>startTime</cite> (requires <code class="docutils literal notranslate"><span class="pre">-startTime</span></code> entry), or <cite>latestTime</cite>. In the last case,
the latest time available in the <code class="docutils literal notranslate"><span class="pre">fields</span></code> directory is used as the initial time (the code exits if
the directory is not present, or it doesn’t contain any time
directories).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-startTime</span></code></p></td>
<td><p>Specifies the initial time of the simulation if the <code class="docutils literal notranslate"><span class="pre">-startFrom</span></code> keyword is set to <cite>startTime</cite>.
Disregarded otherwise.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-endTime</span></code></p></td>
<td><p>Defines the time at which the simulation ends.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-timeStep</span></code></p></td>
<td><p>Initial time step size in seconds.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-adjustTimeStep</span></code></p></td>
<td><p>If set to 0, the time step will remain fixed and equal to the specified <code class="docutils literal notranslate"><span class="pre">-timeStep</span></code>. If set to
1 (requires <code class="docutils literal notranslate"><span class="pre">-cfl</span></code>), the time step will be adjusted based on the CFL value and I/O settings. This
means that time step size will be varied based on the solution, and in order to land on those
time values designated for data writing by the acquisition
system.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-cfl</span></code></p></td>
<td><p>Specifies the CFL value to be maintained. Disregarded if <code class="docutils literal notranslate"><span class="pre">-adjustTimeStep</span></code> is set to 0.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-timePrecision</span></code></p></td>
<td><p>Specifies the number of digits after the comma that are used to write files and expected to read
them. Note that, if the time folder storing the initial condition has a different number of digits,
the simulation will throw an error. To solve this one can act both on the <code class="docutils literal notranslate"><span class="pre">-timePrecision</span></code>, or
rename the folder using a <code class="docutils literal notranslate"><span class="pre">-timePrecision</span></code> that matches that specified inside the <cite>control.dat</cite>
file.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="i-o-controls">
<h4>I/O Controls<a class="headerlink" href="#i-o-controls" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 65.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-intervalType</span></code></p></td>
<td><p>It can be set to <cite>adjustableTime</cite>, <cite>timeStep</cite> or <cite>writeNow</cite>. In the last case, a checkpoint
followed by termination of the simulation will be triggered.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-timeInterval</span></code></p></td>
<td><p>Specifies how often a checkpoint file is written. If the <code class="docutils literal notranslate"><span class="pre">-timeInterval</span></code> is set to
<cite>adjustableTime</cite>, the time interval between two checkpoints is expressed in seconds. If
<code class="docutils literal notranslate"><span class="pre">-timeInterval</span></code> is set to <cite>timeStep</cite>, the time interval refers to the number of iterations.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-purgeWrite</span></code></p></td>
<td><p>If set to 1, eliminates all previous checkpoint files every time that a checkpoint is written
(in order to save disk space).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="solution-flags">
<h4>Solution Flags<a class="headerlink" href="#solution-flags" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 65.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-les</span></code></p></td>
<td><p>Specifies if and which LES model is active:
(1) standard Smagorinsky
(2) stability dependent
(3) dynamic Smagorinsky with box averaging
(4) dynamic Smagorinsky scale invariant with lagrangian averaging (LASI)
(5) dynamic smagorinsky scale dependent with lagrangian averaging (LASD)
(6) dynamic smagorinsky scale dependent with plane averaging (PASD).
TOSCA has been extensively and most used adopting model (4) for ABL and wind plant simulations.
Model (5) provides a good alternative in stably stratified flows.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-potentialT</span></code></p></td>
<td><p>Specifies if potential temperature transport equation is solved (set to 1) or not (set to 0).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-abl</span></code></p></td>
<td><p>Specifies if an ABL simulation is run. Requires additional file <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-ibm</span></code></p></td>
<td><p>Specifies if immersed bodies are present in the simulation (set to 1) or not (set to 0). Requires
additional input in <code class="docutils literal notranslate"><span class="pre">IBM</span></code> directory.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-overset</span></code></p></td>
<td><p>Specifies if overset mesh is present in the simulation. Requires additional input in <code class="docutils literal notranslate"><span class="pre">Overset</span></code>
directory if activated.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-zDampingLayer</span></code></p></td>
<td><p>Specifies if vertical Rayleigh damping layer is present in the simulation. Requires additional
input in <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file if activated.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-xDampingLayer</span></code></p></td>
<td><p>Specifies if horizontal inlet fringe region is present in the simulation. Requires additional input
in <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file if activated. Concurrent precursor can be enabled with this flag.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-yDampingLayer</span></code></p></td>
<td><p>Specifies if horizontal lateral fringe region is present in the simulation. Requires additional input
in <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file if activated. Concurrent precursor <strong>has to</strong> be enabled with this
flag.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-advectionDamping</span></code></p></td>
<td><p>Specifies if horizontal inlet advection damping region is present in the simulation. Requires
additional input in <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file if activated.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-precursorSpinUp</span></code></p></td>
<td><p>Concurrent precursor <strong>has to</strong> be enabled with this flag. Specifies the type of inlet boundary
condition and initial condition for the concurrent precursor. If set to 0, streamwise periodic
boundary conditions are applied and initial condition is read from <code class="docutils literal notranslate"><span class="pre">fields/precursor</span></code> directory.
If set to 1, inlet planes from previous simulation are applied and flow is initialized by
spreading the flow given in the plane corresponding to the simulation start time throughout the
domain. If set to 2 is equivalent to 1, but the initial condition is read from the
<code class="docutils literal notranslate"><span class="pre">fields/precursor</span></code> directory. This is used for coarse concurrent precursor, where a good solution
has to be continuously feed because the simulation cannot be really self-sustained in the concurrent
precursor.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-kLeftRayleigh</span></code></p></td>
<td><p>Specifies if horizontal Rayleigh damping at <code class="docutils literal notranslate"><span class="pre">kLeft</span></code> boundary is present in the simulation.
Requires additional input in <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file if activated.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-kRightRayleigh</span></code></p></td>
<td><p>Specifies if horizontal Rayleigh damping at <code class="docutils literal notranslate"><span class="pre">kRight</span></code> boundary is present in the simulation.
Requires additional input in <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file if activated.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-canopy</span></code></p></td>
<td><p>Specifies if wind farm canopy model is present in the simulation. Requires additional input in
<code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file if activated.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-windplant</span></code></p></td>
<td><p>Specifies if wind turbines are present in the simulation (set to 1) or not (set to 0). Requires
turbine models definitions in <code class="docutils literal notranslate"><span class="pre">turbines</span></code> directory.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-inviscid</span></code></p></td>
<td><p>If set to 1, allows disabling viscous terms. Default value is 0.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-computeContinuity</span></code></p></td>
<td><p>Computes the divergence field within the entire domain and writes it to checkpoint files.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-pvCatalyst</span></code></p></td>
<td><p>Enables <cite>ParaView-Catalyst</cite> off-screen rendering capabilities. Useful to create nice videos of very
large simulations. More details are given in Sec. <a class="reference internal" href="tosca_setup.html#paraview-catalyst-section"><span class="std std-ref">Paraview-Catalyst2 OS-Rendering</span></a>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="solution-controls">
<h4>Solution Controls<a class="headerlink" href="#solution-controls" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 65.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-meshFileType</span></code></p></td>
<td><p>Defines the format of the mesh input file. It can be set to <code class="docutils literal notranslate"><span class="pre">cartesian</span></code> or <code class="docutils literal notranslate"><span class="pre">curvilinear</span></code>.
More details are given in Sec. <a class="reference internal" href="#spatial-mesh-section"><span class="std std-ref">Spatial Mesh</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-dUdtScheme</span></code></p></td>
<td><p>Time discretization scheme, it can be set to <code class="docutils literal notranslate"><span class="pre">forwardEuler</span></code> (explicit first order, usually
unstable), <code class="docutils literal notranslate"><span class="pre">rungeKutta4</span></code> (explicit fourth-order Runge-Kutta) or <code class="docutils literal notranslate"><span class="pre">backwardEuler</span></code>,
which corresponds to the second-order implicit Crank-Nicholson scheme (explicit selection of
the Crank-Nicholson scheme will be made available). For long simulations the
<code class="docutils literal notranslate"><span class="pre">backwardEuler</span></code> scheme is preferred, as it can run with CFL greater than 1 and is
unconditionally stable. For simulations affected by constraints other than the CFL (e.g. blade
rotation in actuator line model), <code class="docutils literal notranslate"><span class="pre">rungeKutta4</span></code> is a good alternative.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-divScheme</span></code></p></td>
<td><p>Determines which divergence scheme is used for the discretization of the advection fluxes. It
can be set to <code class="docutils literal notranslate"><span class="pre">central</span></code> (second-order symmetric scheme, dispersive), <code class="docutils literal notranslate"><span class="pre">quickDiv</span></code> (third-order
upwind-biased quadratic scheme, diffusive), <code class="docutils literal notranslate"><span class="pre">weno3</span></code> (fourth-order weighted essentially
non-oscillatory scheme, diffusive), <code class="docutils literal notranslate"><span class="pre">centralUpwind</span></code> (vanLeer blending of central and quadratic
scheme, to balance diffusion and dispersion), <code class="docutils literal notranslate"><span class="pre">centralUpwindW</span></code> (weighted version, for
graded/non-uniform meshes).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-relTolU</span></code></p></td>
<td><p>Requires <code class="docutils literal notranslate"><span class="pre">-dUdtScheme</span></code> set to <code class="docutils literal notranslate"><span class="pre">backwardEuler</span></code>, discarded otherwise. Allows to set the relative
exit tolerance for the Newton method used to solve implicit discretized momentum equation, default
value 1e-30.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-absTolU</span></code></p></td>
<td><p>Requires <code class="docutils literal notranslate"><span class="pre">-dUdtScheme</span></code> set to <code class="docutils literal notranslate"><span class="pre">backwardEuler</span></code>, discarded otherwise. Allows to set the absolute
exit tolerance for the Newton method used to solve implicit discretized momentum equation,
default value 1e-5.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-poissonSolver</span></code></p></td>
<td><p>Allows to specify the library used to solve the pressure equation, it can be set to <code class="docutils literal notranslate"><span class="pre">HYPRE</span></code> or
<code class="docutils literal notranslate"><span class="pre">PETSc</span></code>. <code class="docutils literal notranslate"><span class="pre">HYPRE</span></code> is suggested, as it has proved to work better than <code class="docutils literal notranslate"><span class="pre">PETSc</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-hypreSolverType</span></code></p></td>
<td><p>Allows to choose the solution method for the linear system if <code class="docutils literal notranslate"><span class="pre">-poissonSolver</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">HYPRE</span></code>, discarded otherwise. Set to 1 to use the Generalized Minimum Residual (GMRES), set
to 2 to use the preconditioned Conjugate-Gradient (PCG) method. Default value is 1.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-poissonTol</span></code></p></td>
<td><p>Allows to set the exit tolerance for the pressure solver. Default value is 1e-8.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-poissonIt</span></code></p></td>
<td><p>Set the maximum number of iterations for the pressure solver. Default value is 8.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-amgCoarsenType</span></code></p></td>
<td><p>Since TOSCA uses the Algebraic Multi-Grid (AMG) preconditioner when the <code class="docutils literal notranslate"><span class="pre">-poissonSolver</span></code> is set
to <code class="docutils literal notranslate"><span class="pre">HYPRE</span></code>, this entry allows to set the coarsening method. Available entries are 0 (CLJP),
6 (Falgout), 8 (PMIS), 10 (HMIS). Default value is 10.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-amgThresh</span></code></p></td>
<td><p>Allows to set the AMG threshold. Default value is 0.5. For distorted meshes, a value of 0.6 is
suggested.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-amgAgg</span></code></p></td>
<td><p>Allows to set the level of aggressive coarsening. Default value is 0 (not used).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-pTildeBuoyancy</span></code></p></td>
<td><p>If set to 1, buoyancy force is recast into a buoyancy gradient and pressure is defined accordingly.
Default value is 0 (not used).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-dTdtScheme</span></code></p></td>
<td><p>Can be set to <code class="docutils literal notranslate"><span class="pre">backwardEuler</span></code> (implicit first-order) or <code class="docutils literal notranslate"><span class="pre">rungeKutta4</span></code> (explicit fourth-order).
For ABL simulations, <code class="docutils literal notranslate"><span class="pre">backwardEuler</span></code> is suggested. Crank-Nicholson has been removed from TOSCA
due to poor velocity-temperature coupling.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-relTolT</span></code></p></td>
<td><p>Requires <code class="docutils literal notranslate"><span class="pre">-dTdtScheme</span></code> set to <code class="docutils literal notranslate"><span class="pre">backwardEuler</span></code>. Allows to set the relative exit tolerance for
the Newton method used to solve implicit discretized temperature equation, default value 1e-30.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-absTolT</span></code></p></td>
<td><p>Requires <code class="docutils literal notranslate"><span class="pre">-dTdtScheme</span></code> set to <code class="docutils literal notranslate"><span class="pre">backwardEuler</span></code>. Allows to set the absolute exit tolerance for
the Newton method used to solve implicit discretized temperature equation, default value 1e-5.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-max_cs</span></code></p></td>
<td><p>Maximum value for the LES model <span class="math notranslate nohighlight">\(C_s\)</span> coefficient, default value is set to 0.5. Only used when
<code class="docutils literal notranslate"><span class="pre">-les</span></code> is greater than 1.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="solution-constants">
<h4>Solution Constants<a class="headerlink" href="#solution-constants" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 65.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-nu</span></code></p></td>
<td><p>Sets the molecular (kinematic) viscosity of the working fluid.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-rho</span></code></p></td>
<td><p>Sets the density of the working fluid (used e.g. to compute forces).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-Pr</span></code></p></td>
<td><p>Requires <code class="docutils literal notranslate"><span class="pre">-potentialT</span></code> to be se to 1. Sets the Prandtl number of the working fluid.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-tRef</span></code></p></td>
<td><p>It is a required parameter when <code class="docutils literal notranslate"><span class="pre">-potentialT</span></code> is active and <code class="docutils literal notranslate"><span class="pre">-abl</span></code> is not. Sets the reference
potential temperature of the flow, otherwise <code class="docutils literal notranslate"><span class="pre">-tRef</span></code> is set inside the <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="acquisition-controls">
<h4>Acquisition Controls<a class="headerlink" href="#acquisition-controls" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 65.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-probes</span></code></p></td>
<td><p>Activates probes acquisition. Requires additional input files inside <code class="docutils literal notranslate"><span class="pre">sampling/probes</span></code> directory.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-sections</span></code></p></td>
<td><p>Activates acquisition of sections to be visualized in <cite>ParaView</cite>. Requires additional input files in
<code class="docutils literal notranslate"><span class="pre">sampling/surfaces</span></code> directory.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-averageABL</span></code></p></td>
<td><p>Activates planar averages at every cell-level in the z-direction. Requires <code class="docutils literal notranslate"><span class="pre">-abl</span></code> to be active.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-averageABLPeriod</span></code></p></td>
<td><p>Output period of the ABL planar averages. It is a required parameter, even if <code class="docutils literal notranslate"><span class="pre">-averageABL</span></code> is set to
0, for concurrent-precursor simulations, where these averages are always active.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-averageABLStartTime</span></code></p></td>
<td><p>Time at which ABL planar averages are started. It is a required parameter, even if <code class="docutils literal notranslate"><span class="pre">-averageABL</span></code> is set to
0, for concurrent-precursor simulations.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-average3LM</span></code></p></td>
<td><p>Activates vertical averages within layer at user-defined points. Requires additional inputs in
<code class="docutils literal notranslate"><span class="pre">sampling</span></code> directory.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-perturbABL</span></code></p></td>
<td><p>Activates acquisition of perturbation fields at the same location as sections to be visualized in ParaView.
Requires additional inputs in <code class="docutils literal notranslate"><span class="pre">sampling</span></code> directory.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-averaging</span></code></p></td>
<td><p>It can be activated by setting to 1, 2, or 3 to get a higher amount of three-dimensional averaged fields.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-avgPeriod</span></code></p></td>
<td><p>Average period of three-dimensional averages. Fields are written at checkpoint times in the correspondent time
folder.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-avgStartTime</span></code></p></td>
<td><p>Start time of three-dimensional averages.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-phaseAveraging</span></code></p></td>
<td><p>These averages are a duplicate of the averages, but are useful if one wants to perform both unconditioned-averages
and phase-averages, e.g. at multiples of some characteristic time, in the same simulation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-phaseAvgPeriod</span></code></p></td>
<td><p>Average period of three-dimensional phase averages. Fields are written at checkpoint times in the correspondent time
folder.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-phaseAvgStartTime</span></code></p></td>
<td><p>Start time of three-dimensional phase averages.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-keBudgets</span></code></p></td>
<td><p>Set to 1 to activate mechanical energy budgets. Requires additional inputs in <code class="docutils literal notranslate"><span class="pre">sampling</span></code> directory.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-writePressureForce</span></code></p></td>
<td><p>Writes pressure force on the IBM surface.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-computeQ</span></code></p></td>
<td><p>Writes 3D field of Q-criterion at checkpoint times.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-computeL2</span></code></p></td>
<td><p>Writes 3D field of Lambda2-criterion at checkpoint times.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-computeFarmForce</span></code></p></td>
<td><p>Writes 3D field of wind farm body force at checkpoint times.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-computeSources</span></code></p></td>
<td><p>Compute source fields to be written in checkpoint files, to be converted in <code class="docutils literal notranslate"><span class="pre">.xmf</span></code> format by
<code class="docutils literal notranslate"><span class="pre">tosca2PV</span></code> executable. Depending on what is active, it calculates the coriolis force and driving
pressure gradient (require <code class="docutils literal notranslate"><span class="pre">-abl</span></code> set to 1), the inlet and lateral fringe source terms (require
<code class="docutils literal notranslate"><span class="pre">-xDampingLayer</span></code> and <code class="docutils literal notranslate"><span class="pre">-yDampingLayer</span></code> set to 1, respectively) and the body force from the canopy
model (requires <code class="docutils literal notranslate"><span class="pre">-canopy</span></code> set to 1).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-computeBuoyancy</span></code></p></td>
<td><p>Writes 3D field of buoyancy term in the momentum equation at checkpoint times.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="post-processing-controls">
<h4>Post Processing Controls<a class="headerlink" href="#post-processing-controls" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 65.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-postProcessFields</span></code></p></td>
<td><p>Activate to post process 3D fields. It should be deactivated (set to 0) for too big cases to be fit in the memory of a
single node, as field conversion from binary to <code class="docutils literal notranslate"><span class="pre">.xmf</span></code> is not parallelized. Note that there is no plans within the
TOSCA developers team to parallelize this feature, as too big cases could not be visualized in <cite>ParaView</cite> anyways due
to RAM limitations. We suggest to use <code class="docutils literal notranslate"><span class="pre">-sections</span></code> instead, where parallel writing is enabled.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-writeRaster</span></code></p></td>
<td><p>Activate to write raster file from jSections.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-sections</span></code></p></td>
<td><p>Activate to post process binary sections and write <code class="docutils literal notranslate"><span class="pre">.xmf</span></code> and <code class="docutils literal notranslate"><span class="pre">.hdf5</span></code> files to be visualized in e.g. <cite>ParaView</cite>.
This feature also works if <code class="docutils literal notranslate"><span class="pre">tosca2PV</span></code> is launched in parallel. When concurrent precursor is activated, those sections
which fall inside the concurrent precursor domain are also processed, so that the user only has to provide one
section definition inside the <code class="docutils literal notranslate"><span class="pre">sampling/surfaces</span></code> directory.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-postProcessPrecursor</span></code></p></td>
<td><p>Activate to also post process fields from the concurrent precursor simulation. Similarly to the <code class="docutils literal notranslate"><span class="pre">-postProcessFields</span></code>
flag, this option is not available in parallel.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="boundary">
<span id="boundary-subsection"></span><h3><cite>boundary</cite><a class="headerlink" href="#boundary" title="Link to this heading"></a></h3>
<p>This section describes the input file definition used to prescribe boundary conditions in TOSCA. TOSCA expects a file for each solved field,
where boundary and initial conditions are specified. Pressure boundary conditions are not required, as they are always of the Neumann type except when
periodicity is present. Therefore, boundary conditions are expected for <em>U</em> (velocity) and <em>nut</em> (turbulent viscosity) fields, as well as for <em>T</em> (potential temperature),
when this is activated in the <em>control.dat</em> file.
Specifically, TOSCA expects to find <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">nut</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code> (if applicable) files, inside a directory named <code class="docutils literal notranslate"><span class="pre">boundary</span></code>. Within each file, boundary conditions
have to be specified for each side of the domain. These are identified as <code class="docutils literal notranslate"><span class="pre">kLeft</span></code>, <code class="docutils literal notranslate"><span class="pre">kRight</span></code>, <code class="docutils literal notranslate"><span class="pre">jLeft</span></code>, <code class="docutils literal notranslate"><span class="pre">jRight</span></code>, <code class="docutils literal notranslate"><span class="pre">iLeft</span></code> and <code class="docutils literal notranslate"><span class="pre">iRight</span></code>. In addition,
the keyword <code class="docutils literal notranslate"><span class="pre">internalField</span></code> has to be specified, which sets the type of initial condition for each of these fields. An example of a <code class="docutils literal notranslate"><span class="pre">boundary/U</span></code> file is given below:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp"># TOSCA Input file - U boundary conditions</span>
<span class="cp"># ----------------------------------------</span>

<span class="n">internalField</span><span class="w"> </span><span class="n">spreadInflow</span>

<span class="n">iLeft</span><span class="w">   </span><span class="n">periodic</span>
<span class="n">iRight</span><span class="w">  </span><span class="n">periodic</span>
<span class="n">jLeft</span><span class="w">   </span><span class="n">noSlip</span>
<span class="n">jRight</span><span class="w">  </span><span class="n">slip</span>
<span class="n">kLeft</span><span class="w">   </span><span class="n">fixedValue</span><span class="w"> </span><span class="p">(</span><span class="mf">5.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">kRight</span><span class="w">  </span><span class="n">zeroGradient</span>
</pre></div>
</div>
<p>In addition to common boundary conditions, which are available at all boundaries, TOSCA also features some special boundary conditions, which are only
available on specific boundaries. These are used for specific simulations, the user is suggested to consider such
constraint when designing and setting up a TOSCA case.</p>
<section id="boundary-conditions">
<h4>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading"></a></h4>
<p>The boundary conditions available in TOSCA are summarized in the following table. The table also specifies the fields for which a given boundary condition is available, together with their entry type and description.</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 20.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>BC type</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fixedValue</span></code></p></td>
<td><p>scalar or vector</p></td>
<td><p>Available for <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">nut</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fixedGradient</span></code></p></td>
<td><p>scalar</p></td>
<td><p>Available for <code class="docutils literal notranslate"><span class="pre">T</span></code>. Entry is a scalar value that refers to the gradient
normal to the patch.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zeroGradient</span></code></p></td>
<td><p>none</p></td>
<td><p>Available for <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">nut</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">slip</span></code></p></td>
<td><p>none</p></td>
<td><p>Available for <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">noSlip</span></code></p></td>
<td><p>none</p></td>
<td><p>Available for <code class="docutils literal notranslate"><span class="pre">U</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">periodic</span></code></p></td>
<td><p>none</p></td>
<td><p>Available for <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">nut</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code>. Requires keywords
<code class="docutils literal notranslate"><span class="pre">-iPeriodicType</span></code>, <code class="docutils literal notranslate"><span class="pre">-jPeriodicType</span></code>, <code class="docutils literal notranslate"><span class="pre">-kPeriodicType</span></code> at the top of
the mesh file, depending on the patch to which it is applied. These should
be placed in the header, before the number of points in each direction, and
indicate the type of parallel connectivity between the periodic boundaries.
For type 1, the domain is decomposed such that periodic cell-pairs lie
within the same processor. Type 2 allows for a more general decomposition
(suggested).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">velocityWallFunction</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Available only for <code class="docutils literal notranslate"><span class="pre">U</span></code>. Applies wall models to velocity.
Only available for <code class="docutils literal notranslate"><span class="pre">iLeft</span></code>, <code class="docutils literal notranslate"><span class="pre">iRight</span></code>, <code class="docutils literal notranslate"><span class="pre">jLeft</span></code> and
<code class="docutils literal notranslate"><span class="pre">jRight</span></code> patches. Not really tested on i-patches. It is usually applied
on the <code class="docutils literal notranslate"><span class="pre">jLeft</span></code> patch in combination with an <code class="docutils literal notranslate"><span class="pre">inletFunction</span></code> on the
<code class="docutils literal notranslate"><span class="pre">kLeft</span></code> patch.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">thetaWallFunction</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Available only for <code class="docutils literal notranslate"><span class="pre">T</span></code>. Applies wall models to temperature.
Only available for <code class="docutils literal notranslate"><span class="pre">iLeft</span></code>, <code class="docutils literal notranslate"><span class="pre">iRight</span></code>, <code class="docutils literal notranslate"><span class="pre">jLeft</span></code> and
<code class="docutils literal notranslate"><span class="pre">jRight</span></code> patches. Not really tested on i-patches. It is usually applied
on the <code class="docutils literal notranslate"><span class="pre">jLeft</span></code> patch in combination with an <code class="docutils literal notranslate"><span class="pre">inletFunction</span></code> on the
<code class="docutils literal notranslate"><span class="pre">kLeft</span></code> patch.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">inletFunction</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Available for <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">nut</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code> only at the <code class="docutils literal notranslate"><span class="pre">kLeft</span></code> patch.</p></td>
</tr>
</tbody>
</table>
<p>The last three boundary conditions listed in the previous table are not available on all patches. On the one hand, the
<code class="docutils literal notranslate"><span class="pre">velocityWallFunction</span></code> and <code class="docutils literal notranslate"><span class="pre">thetaWallFunction</span></code>, used to prescribe wall models, are not available on <code class="docutils literal notranslate"><span class="pre">kLeft</span></code> and <code class="docutils literal notranslate"><span class="pre">kRight</span></code> boundaries. On the
other hand, the <code class="docutils literal notranslate"><span class="pre">inletFunction</span></code> type, used to prescribe special inlet boundary conditions for inlet velocity, temperature and turbulent
viscosity, is only available on the <code class="docutils literal notranslate"><span class="pre">kLeft</span></code> patch. The user should keep this constraint in mind when setting up a TOSCA case.</p>
</section>
<section id="wall-functions">
<h4>Wall Functions<a class="headerlink" href="#wall-functions" title="Link to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">velocityWallFunction</span></code> applies the Shumann wall model, used for ABL flows, or the Cabot wall model, used for wall surfaces, to the velocoty field.
In the Shumann model, the modeled wall shear stress is directly enforced in the stress term of the momentum equations, while a constant normal gradient condition
is applied to the velocity. In order to avoid double counting at the wall when using this condition (the wall shear
stress should be entirely and only modeled), the turbulent viscosity at the wall should be set to zero in the
<code class="docutils literal notranslate"><span class="pre">boundary/nut</span></code> file. Entries for velocity wall functions are summarized in the folllwing table:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 15.0%" />
<col style="width: 20.0%" />
<col style="width: 65.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>WF type</strong></p></td>
<td><p><strong>name</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p>-1</p></td>
<td><p>Cabot wall model</p></td>
<td><p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">velocityWallFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">      </span><span class="mi">-1</span>
<span class="w">   </span><span class="n">kRough</span><span class="w">    </span><span class="mf">0.003</span><span class="w">     </span><span class="c1">// equivalent roughness length</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>-3</p></td>
<td><p>Shumann wall model</p></td>
<td><p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">velocityWallFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">      </span><span class="mi">-3</span>
<span class="w">   </span><span class="n">kRough</span><span class="w">    </span><span class="mf">0.003</span><span class="w">     </span><span class="c1">// equivalent roughness length</span>
<span class="w">   </span><span class="n">gammaM</span><span class="w">    </span><span class="mf">4.9</span><span class="w">       </span><span class="c1">// Shumann model constant</span>
<span class="w">   </span><span class="n">kappa</span><span class="w">     </span><span class="mf">0.4</span><span class="w">       </span><span class="c1">// von Karman constant</span>
<span class="w">   </span><span class="n">thetaRef</span><span class="w">  </span><span class="mf">300.0</span><span class="w">     </span><span class="c1">// reference potential</span>
<span class="w">                       </span><span class="c1">// temperature in Kelvin</span>
<span class="w">   </span><span class="n">uStarEval</span><span class="w"> </span><span class="n">averaged</span><span class="w">  </span><span class="c1">// for laterally homogeneous</span>
<span class="w">                       </span><span class="c1">// flows (e.g. ABL), otherwise</span>
<span class="w">                       </span><span class="c1">// set to &#39;localized&#39; (e.g.</span>
<span class="w">                       </span><span class="c1">// wind farm flows)</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">thetaWallFunction</span></code> is used to select different formulations of the Shumann wall model for potential temperature.
In particular, the modeled heat flux is directly enforced in the stress term of the potential temperature equations,
while a zero normal gradient condition is applied to the temperature field. In order to avoid double counting at the wall when using this condition,
the turbulent viscosity at the wall should be set to zero in the <code class="docutils literal notranslate"><span class="pre">boundary/nut</span></code> file.
Entries for temperature wall functions are summarized in the folllwing table:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 15.0%" />
<col style="width: 20.0%" />
<col style="width: 65.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>WF type</strong></p></td>
<td><p><strong>name</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p>-1</p></td>
<td><p>Shumann wall model,
standard.</p></td>
<td><p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">thetaWallFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">      </span><span class="mi">-3</span>
<span class="w">   </span><span class="n">kRough</span><span class="w">    </span><span class="mf">0.003</span><span class="w">      </span><span class="c1">// equivalent roughness length</span>
<span class="w">   </span><span class="n">gammaM</span><span class="w">    </span><span class="mf">4.9</span><span class="w">        </span><span class="c1">// Shumann model constant</span>
<span class="w">   </span><span class="n">gammaH</span><span class="w">    </span><span class="mf">7.8</span><span class="w">        </span><span class="c1">// Shumann model constant</span>
<span class="w">   </span><span class="n">alphaH</span><span class="w">    </span><span class="mf">1.0</span><span class="w">        </span><span class="c1">// Shumann model constant</span>
<span class="w">   </span><span class="n">kappa</span><span class="w">     </span><span class="mf">0.4</span><span class="w">        </span><span class="c1">// von Karman constant</span>
<span class="w">   </span><span class="n">thetaRef</span><span class="w">  </span><span class="mf">300.0</span><span class="w">      </span><span class="c1">// reference potential</span>
<span class="w">                        </span><span class="c1">// temperature in Kelvin</span>
<span class="w">   </span><span class="n">uStarEval</span><span class="w"> </span><span class="n">averaged</span><span class="w">   </span><span class="c1">// for laterally homogeneous</span>
<span class="w">                        </span><span class="c1">// flows (e.g. ABL), otherwise</span>
<span class="w">                        </span><span class="c1">// set to &#39;localized&#39; (e.g.</span>
<span class="w">                        </span><span class="c1">// wind farm flows)</span>
<span class="w">   </span><span class="n">heatingRate</span><span class="w"> </span><span class="mf">-0.00014</span><span class="w"> </span><span class="c1">// K/s</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>-3</p></td>
<td><p>Shumann wall model, with
specified heat flux.</p></td>
<td><p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">thetaWallFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">      </span><span class="mi">-2</span>
<span class="w">   </span><span class="n">qWall</span><span class="w">     </span><span class="mf">0.003</span><span class="w">     </span><span class="c1">// wall heat flux in J/m2</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>-4</p></td>
<td><p>Shumann wall model, with
specified time history of
surface temperature and Obhukhov
length.</p></td>
<td><p>Only available at <code class="docutils literal notranslate"><span class="pre">jLeft</span></code> patch.
Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">thetaWallFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">      </span><span class="mi">-4</span>
<span class="w">   </span><span class="n">kRough</span><span class="w">    </span><span class="mf">0.003</span><span class="w">      </span><span class="c1">// equivalent roughness length</span>
<span class="w">   </span><span class="n">gammaM</span><span class="w">    </span><span class="mf">4.9</span><span class="w">        </span><span class="c1">// Shumann model constant</span>
<span class="w">   </span><span class="n">gammaH</span><span class="w">    </span><span class="mf">7.8</span><span class="w">        </span><span class="c1">// Shumann model constant</span>
<span class="w">   </span><span class="n">alphaH</span><span class="w">    </span><span class="mf">1.0</span><span class="w">        </span><span class="c1">// Shumann model constant</span>
<span class="w">   </span><span class="n">kappa</span><span class="w">     </span><span class="mf">0.4</span><span class="w">        </span><span class="c1">// von Karman constant</span>
<span class="w">                        </span><span class="c1">// temperature in Kelvin</span>
<span class="w">   </span><span class="n">uStarEval</span><span class="w"> </span><span class="n">averaged</span><span class="w">   </span><span class="c1">// for laterally homogeneous</span>
<span class="w">                        </span><span class="c1">// flows (e.g. ABL), otherwise</span>
<span class="w">                        </span><span class="c1">// set to &#39;localized&#39; (e.g.</span>
<span class="w">                        </span><span class="c1">// wind farm flows)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Look up tables of time (s), surface temperature (K), and Obhukhov length (m),
stored in <code class="docutils literal notranslate"><span class="pre">inflowDatabase/mesoscaleData/time</span></code>,
<code class="docutils literal notranslate"><span class="pre">inflowDatabase/mesoscaleData/surfTemp</span></code> and
<code class="docutils literal notranslate"><span class="pre">inflowDatabase/mesoscaleData/L</span></code>, respectively. All vectors should have same
size.</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="inlet-functions">
<h4>Inlet Functions<a class="headerlink" href="#inlet-functions" title="Link to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">inletFunction</span></code> boundary condition has several different types, each corresponding to a different inlet boundary
condition. These are summarized in the following table:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 15.0%" />
<col style="width: 20.0%" />
<col style="width: 65.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>IF type</strong></p></td>
<td><p><strong>name</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>power law profile</p></td>
<td><p>Power law velocity profile <span class="math notranslate nohighlight">\(\mathbf{U}=
\mathbf{U}_\text{ref}\left(z/H_\text{ref}\right)
^\alpha\)</span>, with <span class="math notranslate nohighlight">\(\alpha=0.107027\)</span>.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">inletFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">      </span><span class="mi">1</span>
<span class="w">   </span><span class="n">Uref</span><span class="w">      </span><span class="n">vector</span>
<span class="w">   </span><span class="n">Href</span><span class="w">      </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">uPrimeRMS</span><span class="w"> </span><span class="n">scalar</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>logarithmic profile</p></td>
<td><p>Logarithmic velocity profile <span class="math notranslate nohighlight">\(\mathbf{U}=
u*/0.4\ln(z/z_0)\mathbf{e}_U\)</span>.
<span class="math notranslate nohighlight">\(\mathbf{U}\)</span> is constant above the
inversion height <span class="math notranslate nohighlight">\(H\)</span> and equal to
<span class="math notranslate nohighlight">\(\mathbf{U}(H)\)</span>.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">inletFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">       </span><span class="mi">2</span>
<span class="w">   </span><span class="n">directionU</span><span class="w"> </span><span class="n">vector</span>
<span class="w">   </span><span class="n">hInversion</span><span class="w"> </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">frictionU</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">kRough</span><span class="w">     </span><span class="n">scalar</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>unsteady mapped inflow</p></td>
<td><p>Maps 2D planes contained in <code class="docutils literal notranslate"><span class="pre">inflowDatabase</span></code>
directory at the inlet. Planes can be tiled
laterally or vertically. Data can also be
extrapolated in the vertical direction. The
extrapolated value can be unsteady or steady. The
latter is calculated by averaging the top data
contained in the 2D planes and slowly merging with
the unsteady data within the last 10 cells of the
2D plane. Note: 2D planes and inlet mesh should be
identical as data is only mapped.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">inletFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">      </span><span class="mi">3</span>
<span class="w">   </span><span class="n">n1Inflow</span><span class="w">  </span><span class="n">integer</span>
<span class="w">   </span><span class="n">n2Inflow</span><span class="w">  </span><span class="n">integer</span>
<span class="w">   </span><span class="n">n1Periods</span><span class="w"> </span><span class="n">integer</span>
<span class="w">   </span><span class="n">n2Periods</span><span class="w"> </span><span class="n">integer</span>
<span class="w">   </span><span class="n">n1Merge</span><span class="w">   </span><span class="kt">bool</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>unsteady interpolated inflow</p></td>
<td><p>Same as type 3, but data is interpolated, hence
the 2D plane mesh and inlet mesh can be different.
Spanwise shift of the inflow data is also
available by setting a lateral shift velocity.
Note that this velocity is not added to the flow
velocity, but rather data are shifted with this
constant lateral velocity.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">inletFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">       </span><span class="mi">4</span>
<span class="w">   </span><span class="n">n1Inflow</span><span class="w">   </span><span class="n">integer</span>
<span class="w">   </span><span class="n">n2Inflow</span><span class="w">   </span><span class="n">integer</span>
<span class="w">   </span><span class="n">n1Periods</span><span class="w">  </span><span class="n">integer</span>
<span class="w">   </span><span class="n">n2Periods</span><span class="w">  </span><span class="n">integer</span>
<span class="w">   </span><span class="n">n1Merge</span><span class="w">    </span><span class="kt">bool</span>
<span class="w">   </span><span class="n">n2Shift</span><span class="w">    </span><span class="kt">bool</span>
<span class="w">   </span><span class="n">shiftSpeed</span><span class="w"> </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">sourceType</span><span class="w"> </span><span class="n">string</span>
<span class="w">   </span><span class="n">cellWidth1</span><span class="w"> </span><span class="n">integer</span>
<span class="w">   </span><span class="n">cellWidth2</span><span class="w"> </span><span class="n">integer</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Nieuwstadt (1983) model</p></td>
<td><p>Applies the Nieuwstadt (1983) model. This is more
sophisticated than the logarithmic profile, as it
also contains wind veer. The wind profile is
rotated such that the prescribed direction is
imposed at the prescribed reference height.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">inletFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">       </span><span class="mi">5</span>
<span class="w">   </span><span class="n">directionU</span><span class="w"> </span><span class="n">vector</span>
<span class="w">   </span><span class="n">hInversion</span><span class="w"> </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">hReference</span><span class="w"> </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">frictionU</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">kRough</span><span class="w">     </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">latitude</span><span class="w">   </span><span class="n">scalar</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>sinusoidally varying i-th component</p></td>
<td><p>Uniform inflow, where the spanwise component
varies sinusoidally with given amplitude and
frequency. Useful to test turbine yaw controllers.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">inletFunction</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">type</span><span class="w">      </span><span class="mi">6</span>
<span class="w">   </span><span class="n">Uref</span><span class="w">      </span><span class="n">vector</span>
<span class="w">   </span><span class="n">amplitude</span><span class="w"> </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">periods</span><span class="w">   </span><span class="n">scalar</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>The different entries required in the <code class="docutils literal notranslate"><span class="pre">inletFunction</span></code> dictionary for each function type are detailed below:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 20.0%" />
<col style="width: 55.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p><em>type 1 - power law profile</em></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Uref</span></code></p></td>
<td><p>vector</p></td>
<td><p>reference velocity in m/s</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Href</span></code></p></td>
<td><p>scalar</p></td>
<td><p>height where <span class="math notranslate nohighlight">\(\mathbf{U}= \mathbf{U}_\text{ref}\)</span> in m</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">uPrimeRMS</span></code></p></td>
<td><p>scalar</p></td>
<td><p>isotropic fluctuation value in m/s</p></td>
</tr>
<tr class="row-even"><td colspan="3"><p><em>type 2 - logarithmic profile</em></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">directionU</span></code></p></td>
<td><p>vector</p></td>
<td><p>velocity direction (will be normalized)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hInversion</span></code></p></td>
<td><p>scalar</p></td>
<td><p>inversion height in m</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">frictionU</span></code></p></td>
<td><p>scalar</p></td>
<td><p>friction velocity in m/s</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kRough</span></code></p></td>
<td><p>scalar</p></td>
<td><p>equivalent roughness length in m</p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><em>type 3 - unsteady mapped inflow</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n1Inflow</span></code></p></td>
<td><p>integer</p></td>
<td><p>number of points in direction 1 (j for kLeft patch)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">n2Inflow</span></code></p></td>
<td><p>integer</p></td>
<td><p>number of points in direction 2 (i for kLeft patch)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n1Periods</span></code></p></td>
<td><p>integer</p></td>
<td><p>number of points in direction 1 for tiling (if target is larger data is extrapolated)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">n2Periods</span></code></p></td>
<td><p>integer</p></td>
<td><p>number of points in direction 2 for tiling (if target is larger data is extrapolated)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n1Merge</span></code></p></td>
<td><p>bool</p></td>
<td><p>average top cell values from 2D planes and merge within 10 top cells. Useful to make
the geostrophic region steady, removing e.g. inertial oscillations.</p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><em>type 4 - unsteady interpolated inflow</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n1Inflow</span></code></p></td>
<td><p>integer</p></td>
<td><p>number of points in direction 1 (j for kLeft patch)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">n2Inflow</span></code></p></td>
<td><p>integer</p></td>
<td><p>number of points in direction 2 (i for kLeft patch)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n1Periods</span></code></p></td>
<td><p>integer</p></td>
<td><p>number of points in direction 1 for tiling (if target is larger data is extrapolated)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">n2Periods</span></code></p></td>
<td><p>integer</p></td>
<td><p>number of points in direction 2 for tiling (if target is larger data is extrapolated)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n1Merge</span></code></p></td>
<td><p>bool</p></td>
<td><p>average top cell from 2D planes and merge within 10 top cells</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">n2Shift</span></code></p></td>
<td><p>bool</p></td>
<td><p>spanwise shift of inflow data</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">shiftSpeed</span></code></p></td>
<td><p>scalar</p></td>
<td><p>spanwise shift velocity in m/s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sourceType</span></code></p></td>
<td><p>string</p></td>
<td><p><em>uniform</em> (requires next two entries) or <em>grading</em> (requires the mesh file used in
the simulation that generated the 2D planes, renamed <code class="docutils literal notranslate"><span class="pre">inflowMesh.xyz</span></code> to be located
inside the <code class="docutils literal notranslate"><span class="pre">inflowDatabase</span></code> directory)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cellWidth1</span></code></p></td>
<td><p>integer</p></td>
<td><p>inflow mesh cell width in direction 1 if <code class="docutils literal notranslate"><span class="pre">sourceType</span></code> <em>uniform</em></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cellWidth2</span></code></p></td>
<td><p>integer</p></td>
<td><p>inflow mesh cell width in direction 2 if <code class="docutils literal notranslate"><span class="pre">sourceType</span></code> <em>uniform</em></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p><em>type 5 - Nieuwstadt (1983) model</em></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">directionU</span></code></p></td>
<td><p>vector</p></td>
<td><p>velocity direction (will be normalized)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hInversion</span></code></p></td>
<td><p>scalar</p></td>
<td><p>inversion height in m</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hReference</span></code></p></td>
<td><p>scalar</p></td>
<td><p>reference height in m at which the wind has the provided direction</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">frictionU</span></code></p></td>
<td><p>scalar</p></td>
<td><p>friction velocity in m/s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hRough</span></code></p></td>
<td><p>scalar</p></td>
<td><p>equivalent roughness length in m</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">latitude</span></code></p></td>
<td><p>scalar</p></td>
<td><p>latitude in degrees</p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><em>type 6 - sinusoidally varying i-th component</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Uref</span></code></p></td>
<td><p>vector</p></td>
<td><p>reference velocity in m/s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">amplitude</span></code></p></td>
<td><p>scalar</p></td>
<td><p>amplitude of the spanwise velocity oscillation in m/s</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">periods</span></code></p></td>
<td><p>scalar</p></td>
<td><p>number of periods contained in the domain length along the i curvilinear direction</p></td>
</tr>
</tbody>
</table>
<p>As an example, a logarithmic profile on the <code class="docutils literal notranslate"><span class="pre">kLeft</span></code> patch is prescribed as follows</p>
<blockquote>
<div><div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">kLeft</span><span class="w"> </span><span class="n">inletFunction</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span><span class="n">type</span><span class="w">        </span><span class="mi">2</span><span class="w">             </span><span class="c1">// type 2 is logarithmic profile</span>
<span class="w">         </span><span class="n">directionU</span><span class="w">  </span><span class="p">(</span><span class="mf">1.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="c1">// velocity is along the x direction</span>
<span class="w">         </span><span class="n">hInversion</span><span class="w">  </span><span class="mi">500</span><span class="w">           </span><span class="c1">// ABL height is 500 m</span>
<span class="w">         </span><span class="n">frictionU</span><span class="w">   </span><span class="mf">0.5</span><span class="w">           </span><span class="c1">// friction velocity is 0.5 m/s</span>
<span class="w">         </span><span class="n">kRough</span><span class="w">      </span><span class="mf">0.001</span><span class="w">         </span><span class="c1">// equivalent roughness lenght is 0.001 m</span>
<span class="w">      </span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="initial-condition">
<h4>Initial Condition<a class="headerlink" href="#initial-condition" title="Link to this heading"></a></h4>
<p>The initial field is finally prescribed after the <code class="docutils literal notranslate"><span class="pre">internalField</span></code> keyword within each boundary condition file. Initial conditions
available within TOSCA are summarized in the following table:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>initial condition type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uniform</span></code></p></td>
<td><p>Available for <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">nu</span></code>, <code class="docutils literal notranslate"><span class="pre">T</span></code>. The <em>value</em> entry can be vector or
scalar.  If the <em>perturbations</em> entry is set to 1, sinusoidal perturbations
are applied to trigger turbulence (only required for <code class="docutils literal notranslate"><span class="pre">U</span></code> field)</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">uniform</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">value</span><span class="w">          </span><span class="n">vector</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">perturbations</span><span class="w">  </span><span class="kt">bool</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">readField</span></code></p></td>
<td><p>Available for <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">nu</span></code>, <code class="docutils literal notranslate"><span class="pre">T</span></code>. Reads field data from the <code class="docutils literal notranslate"><span class="pre">fields</span></code>
directory. Used for simulation restart.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ABLFlow</span></code></p></td>
<td><p>Sets initial log profile for <code class="docutils literal notranslate"><span class="pre">U</span></code>, while <code class="docutils literal notranslate"><span class="pre">T</span></code> is set according to the
Rampanelli and Zardi (2003) model. Requires <code class="docutils literal notranslate"><span class="pre">-abl</span></code> set to 1 in the
<code class="docutils literal notranslate"><span class="pre">control.dat</span></code> file, as it picks input parameters from the
<code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file. Perturbations to trigger turbulence can be
added using the <em>perturbations</em> entry in the <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">spreadInflow</span></code></p></td>
<td><p>Copies the flow from the <code class="docutils literal notranslate"><span class="pre">kLeft</span></code> ghost cells at every <code class="docutils literal notranslate"><span class="pre">k</span></code>-plane. Useful
for ensuring perfect consistency between the inlet boundary condition and
the internal field when using <code class="docutils literal notranslate"><span class="pre">inletFunction</span></code>. In practice, sets the
internal field to whatever the <code class="docutils literal notranslate"><span class="pre">inletFunction</span></code> is.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">linear</span></code></p></td>
<td><p>Only available for <code class="docutils literal notranslate"><span class="pre">T</span></code>. Sets an initial temperature profile characterized
by a linear lapse rate <em>tLapse</em> along <code class="docutils literal notranslate"><span class="pre">j</span></code> and a ground temperature
<em>tRef</em>. Used to prescribe an initially-linear potential temperature
stratification.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">linear</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">tRef</span><span class="w">   </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">tLapse</span><span class="w"> </span><span class="n">scalar</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="ablproperties-dat">
<span id="ablproperties-section"></span><h3><cite>ABLProperties.dat</cite><a class="headerlink" href="#ablproperties-dat" title="Link to this heading"></a></h3>
<p>When the <code class="docutils literal notranslate"><span class="pre">-abl</span></code> flag is activated in the <code class="docutils literal notranslate"><span class="pre">control.dat</span></code> file, TOSCA is prompted to read the <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code> file.
This contains important settings that can be activated for ABL or wind farm simulations with potential temperature
stratification. For example, this file contains settings for the potential temperature profile, it allows to activate
velocity controllers, used to drive the flow when laterally-periodic simulations are applied, the potential temperature
controller, used to fix the potential temperature profile over time, fringe and damping regions, as well as the geostrophic damper,
which avoids inertial oscillations produced when the flow is not initialized in geostrophic balance and the Coriolis force is
active. It is also in this file that one can activate TOSCA’s canopy model or the concurrent precursor method.</p>
<p>Primarily, this file contains entries that are required by TOSCA when the <code class="docutils literal notranslate"><span class="pre">-abl</span></code> flag is activated. In
addition, it contains dictionaries that are required when additional flags are activated in the <code class="docutils literal notranslate"><span class="pre">control.dat</span></code> file, which are
only used for ABL flows. For example, the <code class="docutils literal notranslate"><span class="pre">xDampingProperties</span></code> dictionary is only read if <code class="docutils literal notranslate"><span class="pre">-xDampingLayer</span></code> is set to 1 in
the <code class="docutils literal notranslate"><span class="pre">control.dat</span></code> file.</p>
<p>The folliwing table summarizes all entries and dictionaries available in the <code class="docutils literal notranslate"><span class="pre">ABLProperties.dat</span></code>. A description of
entries specific to each dictionaries is given in the subsequent tables.</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 32.0%" />
<col style="width: 15.0%" />
<col style="width: 53.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry name</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hRough</span></code></p></td>
<td><p>scalar</p></td>
<td><p>equivalent roughness length in m used to set
set the initial velocity condition when
<code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/U</span></code> file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">uRef</span></code></p></td>
<td><p>scalar</p></td>
<td><p>reference velocity in m/s used to set
set the initial condition when
<code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/U</span></code> file. The initial wind will be
a logarthmic profile with this value of velocity
at <code class="docutils literal notranslate"><span class="pre">hRef</span></code>. It is also used by the
velocity controller when <code class="docutils literal notranslate"><span class="pre">controllerType</span></code> is set
to <em>pressure</em> inside the <code class="docutils literal notranslate"><span class="pre">controllerProperties</span></code>
dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hRef</span></code></p></td>
<td><p>scalar</p></td>
<td><p>reference height in m used to set
set the initial condition when
<code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/U</span></code> file. The initial wind will be
a logarthmic profile with velocity <code class="docutils literal notranslate"><span class="pre">uRef</span></code>
at this height. It is also used by the
velocity controller when <code class="docutils literal notranslate"><span class="pre">controllerType</span></code> is set
to <em>pressure</em> inside the <code class="docutils literal notranslate"><span class="pre">controllerProperties</span></code>
dictionary.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hInv</span></code></p></td>
<td><p>scalar</p></td>
<td><p>inversion layer height in m used to set
set the initial potential temperature condition
when <code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/T</span></code> file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dInv</span></code></p></td>
<td><p>scalar</p></td>
<td><p>inversion layer wifth in m used to set
set the initial potential temperature condition
when <code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/T</span></code> file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gInv</span></code></p></td>
<td><p>scalar</p></td>
<td><p>inversion layer strength in K used to set
set the initial potential temperature condition
when <code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/T</span></code> file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gTop</span></code></p></td>
<td><p>scalar</p></td>
<td><p>lapse rate above inversion in K/m used to set
set the initial potential temperature condition
when <code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/T</span></code> file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gABL</span></code></p></td>
<td><p>scalar</p></td>
<td><p>lapse rate below inversion in K/m used to set
set the initial potential temperature condition
when <code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/T</span></code> file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tRef</span></code></p></td>
<td><p>scalar</p></td>
<td><p>reference potential temperaure used to set
set the initial potential temperature condition
when <code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/T</span></code> file. This is also assumed as a
reference temperature throughout the simulation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vkConst</span></code></p></td>
<td><p>scalar</p></td>
<td><p>von Karman constant.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">smearT</span></code></p></td>
<td><p>scalar</p></td>
<td><p>smearing parameter used to define how sharp the
initial potential temperaure profile is, when
when <code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/T</span></code> file. Suggested value is 0.33.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">coriolisActive</span></code></p></td>
<td><p>bool</p></td>
<td><p>Coriolis force activation flag.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fCoriolis</span></code></p></td>
<td><p>scalar</p></td>
<td><p>Coriolis parameter. Should be computed as
<span class="math notranslate nohighlight">\(10^{-5} \cdot 7.272205217sin(\phi)\)</span>,
where <span class="math notranslate nohighlight">\(\phi\)</span> is latitude.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">controllerActive</span></code></p></td>
<td><p>bool</p></td>
<td><p>Velocity controller activation flag. Requires
<code class="docutils literal notranslate"><span class="pre">controllerProperties</span></code> dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">controllerActiveT</span></code></p></td>
<td><p>bool</p></td>
<td><p>Temperature controller activation flag. The target
laterally-averaged potential temperature profile
that the controller aims at maintaining is the
initial one. Requires
<code class="docutils literal notranslate"><span class="pre">controllerProperties</span></code> dictionary.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">controllerActivePrecursorT</span></code></p></td>
<td><p>bool</p></td>
<td><p>Temperature controller activation flag. Same as
<code class="docutils literal notranslate"><span class="pre">controllerActiveT</span></code>, but for the concurrent
precursor simulation. Requires
<code class="docutils literal notranslate"><span class="pre">controllerProperties</span></code> dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">controllerTypeT</span></code></p></td>
<td><p>string</p></td>
<td><p>Temperature controller type <em>initial</em> tries to
maintain the initial horizontally averaged
potential temperature profile. Types
<em>directProfileAssimilation</em> and
<em>indirectProfileAssimilation</em> calculate source
terms to follow a provided time-series of
potential temperature profile. They require
additional entries in the <code class="docutils literal notranslate"><span class="pre">controllerProperties</span></code>
subdictionary, i.e. <code class="docutils literal notranslate"><span class="pre">relaxPI</span></code>,
<code class="docutils literal notranslate"><span class="pre">lowestSrcHeight</span></code>, <code class="docutils literal notranslate"><span class="pre">highestSrcHeight</span></code>.
Moreover, <code class="docutils literal notranslate"><span class="pre">polynomialOrder</span></code> is also required for
controller type <em>indirectProfileAssimilation</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">perturbations</span></code></p></td>
<td><p>bool</p></td>
<td><p>Adds divergence-free sinusoidal perturbations to
triger turbulence in the initial condition when
<code class="docutils literal notranslate"><span class="pre">internalField</span></code> is set to <em>ABLFlow</em> in the
<code class="docutils literal notranslate"><span class="pre">boundary/U</span></code> file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">controllerProperties</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Contains inputs for velocity and temperature
controllers. Required when
<code class="docutils literal notranslate"><span class="pre">controllerActive</span></code>, <code class="docutils literal notranslate"><span class="pre">controllerActiveT</span></code>
or <code class="docutils literal notranslate"><span class="pre">controllerActivePrecursorT</span></code> are set to 1.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">controllerProperties</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">relaxPI</span><span class="w">                </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">controllerMaxHeight</span><span class="w">    </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">controllerType</span><span class="w">         </span><span class="n">string</span>
<span class="w">   </span><span class="n">alphaPI</span><span class="w">                </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">timeWindowPI</span><span class="w">           </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">geostrophicDamping</span><span class="w">     </span><span class="kt">bool</span>
<span class="w">   </span><span class="n">geoDampingAlpha</span><span class="w">        </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">geoDampingStartTime</span><span class="w">    </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">geoDampingTimeWindow</span><span class="w">   </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">hGeo</span><span class="w">                   </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">alphaGeo</span><span class="w">               </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">uGeoMag</span><span class="w">                </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">controllerAvgStartTime</span><span class="w"> </span><span class="n">scalar</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">xDampingProperties</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Defines fringe region parameters, activated with
<code class="docutils literal notranslate"><span class="pre">-xDampingLayer</span></code> 1 in <code class="docutils literal notranslate"><span class="pre">control.dat</span></code>.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">xDampingProperties</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">xDampingStart</span><span class="w">             </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">xDampingEnd</span><span class="w">               </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">xDampingDelta</span><span class="w">             </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">xDampingAlpha</span><span class="w">             </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">xDampingAlphaControlType</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">xDampingLineSamplingYmin</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">xDampingLineSamplingYmax</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">xDampingTimeWindow</span><span class="w">        </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">uBarSelectionType</span><span class="w">         </span><span class="n">integer</span>
<span class="w">   </span><span class="c1">// additional parameters depending</span>
<span class="w">   </span><span class="c1">// on uBarSelectionType (see next</span>
<span class="w">   </span><span class="c1">// table)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <em>uBarSelectionType</em> entry defines how the
reference wind field is calculated inside the
fringe region, and it requires additional
parameters depending on the type. The <strong>concurrent
precursor</strong> (i.e. when this reference field is
solved concurrently with the main simulation) is
activated by setting the <em>uBarSelectionType</em> to
3. TOSCA creates the second simulation instance
automatically, without requiring additional user
parameters.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yDampingProperties</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Defines lateral fringe region parameters,
activated with  <code class="docutils literal notranslate"><span class="pre">-yDampingLayer</span></code> 1 in
<code class="docutils literal notranslate"><span class="pre">control.dat</span></code>.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">yDampingProperties</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">yDampingStart</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">yDampingEnd</span><span class="w">    </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">yDampingDelta</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">yDampingAlpha</span><span class="w">  </span><span class="n">scalar</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">zDampingProperties</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Defines Reyleigh damping layer parameters,
activated with  <code class="docutils literal notranslate"><span class="pre">-zDampingLayer</span></code> 1 in
<code class="docutils literal notranslate"><span class="pre">control.dat</span></code>.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">zDampingProperties</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">zDampingStart</span><span class="w">   </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">zDampingEnd</span><span class="w">     </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">zDampingAlpha</span><span class="w">   </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">zDampingAlsoXY</span><span class="w">  </span><span class="kt">bool</span>
<span class="w">   </span><span class="n">zDampingXYType</span><span class="w">  </span><span class="n">integer</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">advectionDampingProperties</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Defines advection damping regions parameters.
This corresponds to the technique developed by
Lanzilao and Meyers (2022a). It is activated with
<code class="docutils literal notranslate"><span class="pre">-advectionDamping</span></code> 1 in <code class="docutils literal notranslate"><span class="pre">control.dat</span></code>.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">advectionDampingProperties</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">advDampingStart</span><span class="w">       </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">advDampingEnd</span><span class="w">         </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">advDampingDeltaStart</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">advDampingDeltaEnd</span><span class="w">    </span><span class="n">scalar</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">kLeftDampingProperties</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Defines Rayleigh damping layer at the <em>kLeft</em>
patch. Requires <code class="docutils literal notranslate"><span class="pre">-kLeftRayleigh</span></code> set to 1 in
<code class="docutils literal notranslate"><span class="pre">control.dat</span></code>. Damping transitions from zero
to max across a layer of width
<em>kLeftFilterWidth</em> centered at
<em>kLeftFilterHeight</em> and is applied between the
<em>kLeft</em> patch and a plane at a distance
<em>kLeftPatchDist</em> from the <em>kLeft</em> patch to
obtain the desired velocity <em>kLeftDampingUBar</em>.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">kLeftDampingProperties</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">kLeftPatchDist</span><span class="w">     </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">kLeftDampingAlpha</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">kLeftDampingUBar</span><span class="w">   </span><span class="n">vector</span>
<span class="w">   </span><span class="n">kLeftFilterHeight</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">kLeftFilterWidth</span><span class="w">   </span><span class="n">scalar</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kRightDampingProperties</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Defines Rayleigh damping layer at the <em>kRight</em>
patch. Requires <code class="docutils literal notranslate"><span class="pre">-kRightRayleigh</span></code> set to 1 in
<code class="docutils literal notranslate"><span class="pre">control.dat</span></code>. Damping transitions from zero
to max across a layer of width
<em>kRightFilterWidth</em> centered at
<em>kRightFilterHeight</em> and is applied between the
<em>kRight</em> patch and a plane at a distance
<em>kRightPatchDist</em> from the <em>kRight</em> patch to
obtain the desired velocity <em>kRightDampingUBar</em>.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">kRightDampingProperties</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">kRightPatchDist</span><span class="w">     </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">kRightDampingAlpha</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">kRightDampingUBar</span><span class="w">   </span><span class="n">vector</span>
<span class="w">   </span><span class="n">kRightFilterHeight</span><span class="w">  </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">kRightFilterWidth</span><span class="w">   </span><span class="n">scalar</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">canopyProperties</span></code></p></td>
<td><p>dictionary</p></td>
<td><p>Defines input parameters for the canopy model.
Requires <code class="docutils literal notranslate"><span class="pre">-canopy</span></code> set to 1 in <code class="docutils literal notranslate"><span class="pre">control.dat</span></code>
file.</p>
<p>Usage:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">canopyProperties</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">xStartCanopy</span><span class="w">     </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">xEndCanopy</span><span class="w">       </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">yStartCanopy</span><span class="w">     </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">yEndCanopy</span><span class="w">       </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">zStartCanopy</span><span class="w">     </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">zEndCanopy</span><span class="w">       </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">cftCanopy</span><span class="w">        </span><span class="n">scalar</span>
<span class="w">   </span><span class="n">diskDirCanopy</span><span class="w">    </span><span class="n">vector</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>The meaning of the entires required in the dictionaries listed in the above table are described in the following tables.</p>
<section id="controllerproperties">
<h4>controllerProperties<a class="headerlink" href="#controllerproperties" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 20.0%" />
<col style="width: 45.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">relaxPI</span></code></p></td>
<td><p>scalar</p></td>
<td><p>controller gain. To be set between 0 and 1. Used by all controllers characterized by
a <code class="docutils literal notranslate"><span class="pre">controllerAction</span></code> of type <em>write</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">controllerMaxHeight</span></code></p></td>
<td></td>
<td><p>although it is good practice to apply the source term throughout the whole vertical
extent of the domain, this can be used to avoid applying the driving source term
above a specified height, to be specified in meters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">controllerAction</span></code></p></td>
<td><p>string</p></td>
<td><p>can be set to <em>write</em> or <em>read</em>. The former controls the flow based on different
types of calculated driving pressure gradients, then writes the source terms to file.
The latter reads these previously written source terms and directly applies them with
no feedback controlling action. This keyword has to be set in combination with
<code class="docutils literal notranslate"><span class="pre">controllerType</span></code>. Types <em>pressure</em>, <em>geostrophic</em>, <em>directProfileAssimilation</em> and
<em>indirectProfileAssimilation</em> require <code class="docutils literal notranslate"><span class="pre">controllerAction</span></code> set to <em>write</em>, while
<em>timeSeries</em>, <em>timeAverageSeries</em> and <em>timeHeightSeries</em> require <code class="docutils literal notranslate"><span class="pre">controllerAction</span></code>
set to <em>read</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">controllerType</span></code></p></td>
<td><p>string</p></td>
<td><p>type <em>pressure</em> is the basic PI controller for ABL simulations, it tries to maintain
a wind speed of magnitude <code class="docutils literal notranslate"><span class="pre">uRef</span></code>, aligned with the x-axis, at <code class="docutils literal notranslate"><span class="pre">hRef</span></code>. It writes
the required source terms to file, to be used later in wind farm simulations with
inlet-outlet BCs through the type <em>timeSeries</em> or <em>timeAverageSeries</em>, where source
terms are read or averaged, respectively, from the <code class="docutils literal notranslate"><span class="pre">inflowDatabase/momentumSource</span></code>
file. When trying to attain a specific wind at <code class="docutils literal notranslate"><span class="pre">hRef</span></code> inside the boundary layer
and the Coriolis force is active, the <em>pressure</em> controller produces inertial
oscillations of the geostrophic wind since it is impossible to initialize the flow
in geostrophic balance. In this case, once should either use <code class="docutils literal notranslate"><span class="pre">geostrophicDamping</span></code>
or controller type <code class="docutils literal notranslate"><span class="pre">geostrophic</span></code>. The latter tries to attain
a velocity <code class="docutils literal notranslate"><span class="pre">uGeoMag</span></code> at <code class="docutils literal notranslate"><span class="pre">hGeo</span></code> (which should be above the boundary layer). The
wind field is then rotated such that the flow is aligned with the x-axis at <code class="docutils literal notranslate"><span class="pre">hRef</span></code>.
Note that, at every restart, the initial geostrophic wind angle w.r.t. the x-axis
<code class="docutils literal notranslate"><span class="pre">alphaGeo</span></code> should be provided (the user can take this info in the last iteration
of the previous run, printed on the log file). TOSCA also features profile
assimilation techniques, used to drive the flow following observation profiles.
These can be set with controller type <em>directProfileAssimilation</em> or
<em>indirectProfileAssimilation</em>, and require the observed time series inside
<code class="docutils literal notranslate"><span class="pre">inflowDatabase/mesoscaleData</span></code>. An example can be found in
<code class="docutils literal notranslate"><span class="pre">tests/directProfileAssimilationTest</span></code>. Once these controllers compute and write
the time series of source terms to file, this can be re-applied within wind farm
simulations using the controller type <em>timeHeightSeries</em>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">alphaPI</span></code></p></td>
<td><p>scalar</p></td>
<td><p>proportional over integral controlling action used by all controllers characterized
by a <code class="docutils literal notranslate"><span class="pre">controllerAction</span></code> of type <em>write</em>. A too low value makes the controller
unstable, usually set between 0.6 and 0.9.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">timeWindowPI</span></code></p></td>
<td><p>scalar</p></td>
<td><p>time filter for integral part of the controller, used by all controllers
characterized  by a <code class="docutils literal notranslate"><span class="pre">controllerAction</span></code> of type <em>write</em>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">geostrophicDamping</span></code></p></td>
<td><p>bool</p></td>
<td><p>activates geostrophic damping to remove inertial oscillations. Only for controller
type <em>pressure</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">geoDampingAlpha</span></code></p></td>
<td><p>scalar</p></td>
<td><p>ratio of damping over critical damping coefficient, usually set to 1.0 (critical
damping). Values above 1.0 mean over-damping, values below 1.0 mean under-damping.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">geoDampingStartTime</span></code></p></td>
<td></td>
<td><p>start time of geostrophic damping action. Has to be long enough to provide a good
guess on the geostrophic wind components. Usually set greater than one period of
inertial oscillation (<span class="math notranslate nohighlight">\(2\pi/f_c\)</span>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">geoDampingTimeWindow</span></code></p></td>
<td><p>scalar</p></td>
<td><p>time filter of the deduced geostrophic wind components. Usually set to 1/10 of
the inertial oscillation period (<span class="math notranslate nohighlight">\(0.2\pi/f_c\)</span>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hGeo</span></code></p></td>
<td><p>scalar</p></td>
<td><p>height used to sample the geostrophic wind components for the controller type
<em>geostrophic</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">alphaGeo</span></code></p></td>
<td><p>scalar</p></td>
<td><p>initial wind angle with respect to the x-axis at <code class="docutils literal notranslate"><span class="pre">hGeo</span></code>. This as to be set at
every restart of the simulation. For the first run, one can initialize the wind
aligned with the x-axis and this parameter to zero. Then, the controller will start
to slowly rotate the wind. The wind angle at <code class="docutils literal notranslate"><span class="pre">hGeo</span></code> will be printed in the log file
and the user can set this parameter to the value obtained at the last iteration of
the previous run when restarting.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uGeoMag</span></code></p></td>
<td><p>scalar</p></td>
<td><p>desired geostrophic wind magnitude for controller type <em>geostrophic</em>. At the first
run, the initial flow should match this value at <code class="docutils literal notranslate"><span class="pre">hGeo</span></code> to avoid inertial
oscillations.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">controllerAvgStartTime</span></code></p></td>
<td><p>scalar</p></td>
<td><p>time after which source terms are averaged before being applied. Used for controller
type <em>timeAverageSeries</em>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">avgSources</span></code></p></td>
<td><p>bool</p></td>
<td><p>whether or not to filter the calculated source terms for controller types
<em>directProfileAssimilation</em> and <em>indirectProfileAssimilation</em>. Requires
<code class="docutils literal notranslate"><span class="pre">movingAvgWindow</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">movingAvgWindow</span></code></p></td>
<td><p>scalar</p></td>
<td><p>moving average time window used by controller types <em>directProfileAssimilation</em> and
<em>indirectProfileAssimilation</em> to filter the calculated source terms. Usually on the
order of 100 s.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lowestSrcHeight</span></code></p></td>
<td><p>scalar</p></td>
<td><p>Source term is constant below this height. Used by controller types
<em>directProfileAssimilation</em> and <em>indirectProfileAssimilation</em> to avoid interfering
with the SGS model inside the boundary layer. Usually set to the mean boundaryr layer
height.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">highestSrcHeight</span></code></p></td>
<td><p>scalar</p></td>
<td><p>Source term is constant above this height. Used by controller types
<em>directProfileAssimilation</em> and <em>indirectProfileAssimilation</em>. Usually not required
so set above the max domain height.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">polynomialOrder</span></code></p></td>
<td><p>integer</p></td>
<td><p>Polynomial order for source term fitting used by controller type
<em>indirectProfileAssimilation</em>. Usually set to 5th order.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="xdampingproperties">
<h4>xDampingProperties<a class="headerlink" href="#xdampingproperties" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 20.0%" />
<col style="width: 45.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">xDampingStart</span></code></p></td>
<td><p>scalar</p></td>
<td><p>start x coordinate of the x fringe region in meters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">xDampingEnd</span></code></p></td>
<td><p>scalar</p></td>
<td><p>end x coordinate of the x fringe region in meters.
Should be greather than <code class="docutils literal notranslate"><span class="pre">xDampingStart</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">xDampingDelta</span></code></p></td>
<td><p>scalar</p></td>
<td><p>distance over which the damping action goes from 0 to <span class="math notranslate nohighlight">\(\alpha\)</span>. It must be
smaller than (<code class="docutils literal notranslate"><span class="pre">xDampingEnd</span></code> - <code class="docutils literal notranslate"><span class="pre">xDampingStart</span></code>)/2.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">xDampingAlpha</span></code></p></td>
<td><p>scalar</p></td>
<td><p>damping coefficient <span class="math notranslate nohighlight">\(\alpha\)</span>. Usually set to 0.3.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uBarSelectionType</span></code></p></td>
<td><p>integer</p></td>
<td><p>type of reference velocity computation within the fringe region. This allows to
activate the concurrent precursor method.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">uBarSelectionType</span></code> 0 : corresponds to inletFunction 2 throughout the fringe
region, requires the same parameters inside <code class="docutils literal notranslate"><span class="pre">xDampingProperties</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uBarSelectionType</span></code> 1: corresponds to inletFunction 3 throughout the fringe
region, requires the same parameters inside <code class="docutils literal notranslate"><span class="pre">xDampingProperties</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uBarSelectionType</span></code> 2: corresponds to inletFunction 4 throughout the fringe
region, requires the same parameters inside <code class="docutils literal notranslate"><span class="pre">xDampingProperties</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uBarSelectionType</span></code> 3: corresponds concurrent precursor, no additional
parameters are required, TOSCA creates a child case inferring all inputs from files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uBarSelectionType</span></code> 4: corresponds to inletFunction 5 throughout the fringe
region, requires the same parameters inside <code class="docutils literal notranslate"><span class="pre">xDampingProperties</span></code>.</p></li>
</ul>
<p>See section <a class="reference internal" href="#boundary-subsection"><span class="std std-ref">boundary</span></a> for details on inletFunctions.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">xDampingAlphaControlType</span></code></p></td>
<td><p>string</p></td>
<td><p>type of alpha computation, only for concurrent precursor method (i.e.
<code class="docutils literal notranslate"><span class="pre">uBarSelectionType</span></code> = 3). Most used type is <em>alphaFixed</em>, where the damping
coefficient is specified by <code class="docutils literal notranslate"><span class="pre">xDampingAlpha</span></code>. Moreover, we developed an experimental
variable-alpha fringe region where the damping coefficient is optimized in time.
In particular, TOSCA tries to find the minimum <span class="math notranslate nohighlight">\(\alpha\)</span> that allows to obtain an
average velocity over a line spanning the domain along y, located at <code class="docutils literal notranslate"><span class="pre">hRef</span></code> and
close to the exit of the fringe region, which is as close as possibe to the velocity
sampled on the same line defined in the concurrent precursor domain.
Alpha is slowly increased until the two velocity match. This is meant to be used for
tuning runs with a coarse mesh. The resulting alpha can then be set using
<em>alphaFixed</em> for production runs.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">xDampingLineSamplingYmin</span></code></p></td>
<td><p>scalar</p></td>
<td><p>minimum y of the line located at the fringe exit and at a height of <code class="docutils literal notranslate"><span class="pre">hRef</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">xDampingLineSamplingYmax</span></code></p></td>
<td><p>scalar</p></td>
<td><p>maximum y of the line located at the fringe exit and at a height of <code class="docutils literal notranslate"><span class="pre">hRef</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">xDampingTimeWindow</span></code></p></td>
<td><p>scalar</p></td>
<td><p>time window for error filtering. Sould be greater or equal than a fringe flow
turnover time.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ydampingproperties">
<h4>yDampingProperties<a class="headerlink" href="#ydampingproperties" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 20.0%" />
<col style="width: 45.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yDampingStart</span></code></p></td>
<td><p>scalar</p></td>
<td><p>start y coordinate of the y fringe region in meters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yDampingEnd</span></code></p></td>
<td><p>scalar</p></td>
<td><p>end y coordinate of the y fringe region in meters.
Should be greather than <code class="docutils literal notranslate"><span class="pre">yDampingStart</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yDampingDelta</span></code></p></td>
<td><p>scalar</p></td>
<td><p>distance over which the damping action goes from 0 to <span class="math notranslate nohighlight">\(\alpha\)</span>. It must be
smaller than (<code class="docutils literal notranslate"><span class="pre">yDampingEnd</span></code> - <code class="docutils literal notranslate"><span class="pre">yDampingStart</span></code>)/2.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yDampingAlpha</span></code></p></td>
<td><p>scalar</p></td>
<td><p>damping coefficient <span class="math notranslate nohighlight">\(\alpha\)</span>. Usually set to 0.3.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yDampingNumPeriods</span></code></p></td>
<td><p>integer</p></td>
<td><p>TOSCA uses a tiling approach which maps data from the x fringe region to the y fringe
region in order to define the unperturbed velocity and temperature fields within the
y fringe region. Hence, y fringe region is only available when also the x fringe
region is active, and when the <code class="docutils literal notranslate"><span class="pre">uBarSelectionType</span></code> is set to 3. Usage of the y
fringe region is subject to two main constraints:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(L_x\)</span> / (<code class="docutils literal notranslate"><span class="pre">xDampingEnd</span></code> - <code class="docutils literal notranslate"><span class="pre">xDampingStart</span></code>) = <code class="docutils literal notranslate"><span class="pre">yDampingNumPeriods</span></code>,
where <span class="math notranslate nohighlight">\(L_x\)</span> is the streamwise domain length.</p></li>
<li><p>the end of the x fringe region should coincide with a mesh coordinate in the x
axis.</p></li>
</ul>
<p>These two constraints are checked, so not satisfying them will result in an error.</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="zdampingproperties">
<h4>zDampingProperties<a class="headerlink" href="#zdampingproperties" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 20.0%" />
<col style="width: 45.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zDampingStart</span></code></p></td>
<td><p>scalar</p></td>
<td><p>start z coordinate of the z Rayleigh damping layer in meters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">zDampingEnd</span></code></p></td>
<td><p>scalar</p></td>
<td><p>end z coordinate of the z Rayleigh damping layer in meters.
Should be greather than <code class="docutils literal notranslate"><span class="pre">zDampingStart</span></code>, usually it is set coincident with the top
of the computational domain. Notably, the damping action goes from 0 at
<code class="docutils literal notranslate"><span class="pre">zDampingStart</span></code> to <span class="math notranslate nohighlight">\(\alpha\)</span> at <code class="docutils literal notranslate"><span class="pre">zDampingEnd</span></code>, so setting the latter to
values higher than the domain height is wrong.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zDampingAlpha</span></code></p></td>
<td><p>scalar</p></td>
<td><p>damping coefficient <span class="math notranslate nohighlight">\(\alpha\)</span>. Usually set to <span class="math notranslate nohighlight">\(3\sqrt{g\Gamma/\theta_0}\)</span>,
where <span class="math notranslate nohighlight">\(g\)</span> is the value of the gravitational acceleration, <span class="math notranslate nohighlight">\(\Gamma\)</span> is the
free atmosphere lapse rate, defined by <code class="docutils literal notranslate"><span class="pre">gTop</span></code> and <span class="math notranslate nohighlight">\(\theta_0\)</span> is the reference
potential temperature, defined by <code class="docutils literal notranslate"><span class="pre">tRef</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">zDampingAlsoXY</span></code></p></td>
<td><p>bool</p></td>
<td><p>If set to 0, damping only acts on the vertical velocity with null velocity as the
reference state (classic Rayleigh damping). If set to 1, horizontal components are
also damped as specified by <code class="docutils literal notranslate"><span class="pre">zDampingXYType</span></code>. This is usually set to 0, as
horizontal velocity components should be damped with x and y fringes or kLeft and
kRight Rayleigh damping layers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zDampingXYType</span></code></p></td>
<td><p>integer</p></td>
<td><p>Specifies how to chose the reference velocity used to perform horizontal damping. If
set to 1, velocity is averaged for each j index, along the i index of the mesh (the
simulation setup should be such that they correspond to z and y, respectively) at
the kLeft patch. The resulting vertical velocity profile is used as reference state.
If set to 2, velocity is horizontally averaged from the concurrent precursor domain (
requires x fringe with <code class="docutils literal notranslate"><span class="pre">uBarSelectionType</span></code> 3).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="advectiondampingproperties">
<h4>advectionDampingProperties<a class="headerlink" href="#advectiondampingproperties" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 20.0%" />
<col style="width: 45.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">advDampingStart</span></code></p></td>
<td><p>scalar</p></td>
<td><p>start x coordinate of the x advection damping layer in meters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">advDampingEnd</span></code></p></td>
<td><p>scalar</p></td>
<td><p>end x coordinate of the x advection damping layer in meters.
Should be greather than <code class="docutils literal notranslate"><span class="pre">advDampingStart</span></code>. See Lanzilao &amp; Meyers (2022):
An Improved Fringe-Region Technique for the Representation of Gravity Waves in Large
Eddy Simulation with Application to Wind Farms for optimal setup of these parameters
with respect to the location of the x fringe region.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">advDampingDeltaStart</span></code></p></td>
<td><p>scalar</p></td>
<td><p>distance over which the damping action goes from 0 to 1 (complete removal of
horizontal advection of vertical velocity). The sum of <code class="docutils literal notranslate"><span class="pre">advDampingDeltaStart</span></code> and
<code class="docutils literal notranslate"><span class="pre">advDampingDeltaEnd</span></code> should be less than <code class="docutils literal notranslate"><span class="pre">advDampingEnd</span></code> - <code class="docutils literal notranslate"><span class="pre">advDampingStart</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">advDampingDeltaEnd</span></code></p></td>
<td><p>scalar</p></td>
<td><p>distance over which the damping goes back to 1. Usually larger than
<code class="docutils literal notranslate"><span class="pre">advDampingDeltaStart</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="kleftdampingproperties">
<h4>kLeftDampingProperties<a class="headerlink" href="#kleftdampingproperties" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 20.0%" />
<col style="width: 45.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kLeftPatchDist</span></code></p></td>
<td><p>scalar</p></td>
<td><p>width of the k Raileigh damping region, given as distance from the kLeft patch.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">kLeftDampingAlpha</span></code></p></td>
<td><p>scalar</p></td>
<td><p>damping coefficient <span class="math notranslate nohighlight">\(\alpha\)</span>. Usually set to 0.3.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kLeftDampingUBar</span></code></p></td>
<td><p>vector</p></td>
<td><p>reference unpertuerbed velocity that should be obtained when the flow exits the
Rayleigh damping region. Notably, if the kLeft is the inlet patch, this should be
consistent with the inlet boundary condition, which should be steady above
<code class="docutils literal notranslate"><span class="pre">kLeftFilterHeight</span></code>. This can be obtained by using inletFunction type 4 with
<code class="docutils literal notranslate"><span class="pre">n1Merge</span></code> activated, so that extrapolated values are averaged in time. To know the
<code class="docutils literal notranslate"><span class="pre">kLeftDampingUBar</span></code>, the user can run a tentative simulation with a dummy
<code class="docutils literal notranslate"><span class="pre">kLeftDampingUBar</span></code> and the <code class="docutils literal notranslate"><span class="pre">n1Merge</span></code> activated. At simulation startup. after
averaging the inflow data, velocity values will be printed in the TOSCA log file.
The consistent <code class="docutils literal notranslate"><span class="pre">kLeftDampingUBar</span></code> will be the value at the highest cell.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">kLeftFilterHeight</span></code></p></td>
<td><p>scalar</p></td>
<td><p>Filter height for turbulent flow. It should be set to the height of the incoming
boundary layer, damping will only be applied above, while turbulence will allowed
through below.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kLeftFilterWidth</span></code></p></td>
<td><p>scalar</p></td>
<td><p>Sharpness of the filter in m. The filtering function is such that damping is 1% at
<code class="docutils literal notranslate"><span class="pre">kLeftFilterHeight</span></code> - <code class="docutils literal notranslate"><span class="pre">kLeftFilterWidth</span></code>/2 and 99% at <code class="docutils literal notranslate"><span class="pre">kLeftFilterHeight</span></code> +
<code class="docutils literal notranslate"><span class="pre">kLeftFilterWidth</span></code>/2.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="krightdampingproperties">
<h4>kRightDampingProperties<a class="headerlink" href="#krightdampingproperties" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 20.0%" />
<col style="width: 45.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kRightPatchDist</span></code></p></td>
<td><p>scalar</p></td>
<td><p>width of the k Raileigh damping region, given as distance from the kRight patch.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">kRightDampingAlpha</span></code></p></td>
<td><p>scalar</p></td>
<td><p>damping coefficient <span class="math notranslate nohighlight">\(\alpha\)</span>. Usually set to 0.3.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kRightDampingUBar</span></code></p></td>
<td><p>vector</p></td>
<td><p>reference unpertuerbed velocity that should be obtained when the flow exits the
Rayleigh damping region. It should be consistent with the incoming flow. As kRight
and kLeft damping are usually employed together, <code class="docutils literal notranslate"><span class="pre">kRightDampingUBar</span></code> and
<code class="docutils literal notranslate"><span class="pre">kLeftDampingUBar</span></code> should be the same.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">kRightFilterHeight</span></code></p></td>
<td><p>scalar</p></td>
<td><p>Filter height for turbulent flow. It should be set to the height of the incoming
boundary layer, damping will only be applied above, while turbulence will allowed
through below.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kRightFilterWidth</span></code></p></td>
<td><p>scalar</p></td>
<td><p>Sharpness of the filter in m. The filtering function is such that damping is 1% at
<code class="docutils literal notranslate"><span class="pre">kRightFilterHeight</span></code> - <code class="docutils literal notranslate"><span class="pre">kRightFilterWidth</span></code>/2 and 99% at <code class="docutils literal notranslate"><span class="pre">kRightFilterHeight</span></code> +
<code class="docutils literal notranslate"><span class="pre">kRightFilterWidth</span></code>/2.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="canopyproperties">
<h4>canopyProperties<a class="headerlink" href="#canopyproperties" title="Link to this heading"></a></h4>
<table class="docutils align-center">
<colgroup>
<col style="width: 35.0%" />
<col style="width: 20.0%" />
<col style="width: 45.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">xStartCanopy</span></code></p></td>
<td><p>scalar</p></td>
<td><p>start x coordinate of the canopy box.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">xEndCanopy</span></code></p></td>
<td><p>scalar</p></td>
<td><p>end x coordinate of the canopy box.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yStartCanopy</span></code></p></td>
<td><p>scalar</p></td>
<td><p>start y coordinate of the canopy box.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yEndCanopy</span></code></p></td>
<td><p>scalar</p></td>
<td><p>end y coordinate of the canopy box.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zStartCanopy</span></code></p></td>
<td><p>scalar</p></td>
<td><p>start z coordinate of the canopy box.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">zEndCanopy</span></code></p></td>
<td><p>scalar</p></td>
<td><p>end z coordinate of the canopy box.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cftCanopy</span></code></p></td>
<td><p>scalar</p></td>
<td><p>planform averaged thrust coefficient for the canopy model. It can be evaluated as
<span class="math notranslate nohighlight">\(4\pi C_T/(4S_xS_y)\)</span>. It is still debated if <span class="math notranslate nohighlight">\(C_T\)</span> should be the
freestream or the disk based thrust coefficient. Here we suggest disk based.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">diskDirCanopy</span></code></p></td>
<td><p>vector</p></td>
<td><p>vector that defines the direction of the force applied from the canopy to the flow.
It is automatically normalized by TOSCA.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="turbines">
<span id="turbines-section"></span><h3><cite>turbines</cite><a class="headerlink" href="#turbines" title="Link to this heading"></a></h3>
<p>This section describes how wind turbines can be activated in TOSCA. By setting the <code class="docutils literal notranslate"><span class="pre">-windplant</span></code>
flag to 1 in the <em>control.dat</em> file, TOSCA is prompted to read turbine and farm parameters
inside the <code class="docutils literal notranslate"><span class="pre">turbines</span></code> directory. The structure of a wind farm definition in TOSCA works as
follows. The list of all wind turbines present in the simulation is defined in the <code class="docutils literal notranslate"><span class="pre">windFarmProperties</span></code>
file. Here, the user can define how frequently wind turbine variables are written to file, as well
as the type, model, location and activation of global wind farm controller for each wind
turbine in the list. Such file has the following syntax:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp"># TOSCA Input file - Wind Farm Properties</span>
<span class="cp"># -------------------------------------------</span>

<span class="n">windFarmName</span><span class="w">            </span><span class="n">string</span>
<span class="n">arraySpecification</span><span class="w">      </span><span class="n">string</span>
<span class="n">debug</span><span class="w">                   </span><span class="kt">bool</span>

<span class="n">writeSettings</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">timeStart</span><span class="w">           </span><span class="n">scalar</span>
<span class="w">    </span><span class="n">intervalType</span><span class="w">        </span><span class="n">string</span>
<span class="w">    </span><span class="n">timeInterval</span><span class="w">        </span><span class="n">scalar</span>
<span class="p">}</span>

<span class="n">turbineArray</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">turbineID_1</span>
<span class="w">    </span><span class="p">(</span>
<span class="w">        </span><span class="n">turbineType</span><span class="w">         </span><span class="n">string</span>
<span class="w">        </span><span class="n">turbineModel</span><span class="w">        </span><span class="n">string</span>
<span class="w">        </span><span class="n">baseLocation</span><span class="w">        </span><span class="n">vector</span>
<span class="w">        </span><span class="n">windFarmController</span><span class="w">  </span><span class="kt">bool</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="o">:</span>
<span class="w">    </span><span class="o">:</span>
<span class="w">    </span><span class="o">:</span>
<span class="w">    </span><span class="n">turbineID_N</span>
<span class="w">    </span><span class="p">(</span>
<span class="w">        </span><span class="n">turbineType</span><span class="w">         </span><span class="n">string</span>
<span class="w">        </span><span class="n">turbineModel</span><span class="w">        </span><span class="n">string</span>
<span class="w">        </span><span class="n">baseLocation</span><span class="w">        </span><span class="n">vector</span>
<span class="w">        </span><span class="n">windFarmController</span><span class="w">  </span><span class="kt">bool</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">windFarmName</span></code> identifies the name of the wind farm, and it is totally up to the user to set it. Regarding <code class="docutils literal notranslate"><span class="pre">arraySpecification</span></code>,
TOSCA currenty only supports the <em>onebyone</em> specification type, which is the most generic and allows to define all types of
wind farms. In the future, we might add the <em>aligned</em> and <em>staggered</em> types, which do not require to specify each wind turbine
individually. Notably, these layouts can still be obtained with the current format. The <code class="docutils literal notranslate"><span class="pre">debug</span></code> flag prints to screen
useful wind farm information at each iteration, but requires more processor communication when it is activated, so we suggest
to set it to zero for production runs. The <code class="docutils literal notranslate"><span class="pre">writeSettings</span></code> dictionary allows to set parameters for the wind turbine acquisition
system. The <code class="docutils literal notranslate"><span class="pre">timeStart</span></code> entry, defined in seconds, defines the time at which TOSCA starts to write turbine data to file. The
frequency at which this operation happens can be specified using the next two entries. Specifically, <code class="docutils literal notranslate"><span class="pre">intervalType</span></code> can be set
to <em>timeStep</em> or <em>adjustableTime</em>. In the first case, turbine data are written to file every <code class="docutils literal notranslate"><span class="pre">timeInterval</span></code> iterations (which
has to be an integer), in the second case data are written every <code class="docutils literal notranslate"><span class="pre">timeInterval</span></code> seconds (which can be a scalar value with decimals).
Notably, in this case the <code class="docutils literal notranslate"><span class="pre">-adjustTimeStep</span></code> flag has to be set to 1 in the <em>control.dat</em> file, and TOSCA will adjust the time
step to land on multiples of the <code class="docutils literal notranslate"><span class="pre">timeInterval</span></code> specified by the user.</p>
<p>Regarding the definition of the wind turbine list, this can be of arbitrary length. The name of each entry (e.g. <em>turbineID_1</em>, <em>turbineID_N</em>)
is a string which must be specified by the user. This will be the name of the file where TOSCA will write each turbine’s acquisition data,
and it will be saved in the <code class="docutils literal notranslate"><span class="pre">postProcessing/turbines/startTime</span></code> folder, which will be created at the start of the simulation.
At each simulation restart, the <code class="docutils literal notranslate"><span class="pre">startTime</span></code> will differ, so TOSCA will not overwrite the turbine data. In the follwing table,
the entries required for each turbine in the <code class="docutils literal notranslate"><span class="pre">windFarmProperties</span></code> file are detailed.</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 20.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">turbineType</span></code></p></td>
<td><p>string</p></td>
<td><p>Name of the file defining the wind turbine model. Different wind turbines
can be present in the same wind farm. For example, if the wind turbine is
<em>ModelA</em>, a file with this name should be contained inside the <code class="docutils literal notranslate"><span class="pre">turbines</span></code>
directory. See below for entries to this file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">turbineModel</span></code></p></td>
<td><p>string</p></td>
<td><p>Actuator model used to represent the wind turbine in the flow domain.
Inputs to the model are contained in the wind turbine model file. Available
models are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ALM</span></code>: actuator line model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ADM</span></code>: actuator disk model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uniformADM</span></code>: uniform actuator disk model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AFM</span></code>: actuator farm model</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">baseLocation</span></code></p></td>
<td><p>vector</p></td>
<td><p>vector defining the coordinates of the base location.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">windFarmController</span></code></p></td>
<td><p>bool</p></td>
<td><p>Wether or not the wind farm controller is active. If the controller is
active for this turbine, an addition file is required, located in
<code class="docutils literal notranslate"><span class="pre">turbines/control</span></code>. This a look up table that should have the following
format:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp"># wind farm control table given as a function of time and pitch/DeltaCT</span>
<span class="n">time_1</span><span class="w"> </span><span class="n">pitch_1</span><span class="o">/</span><span class="n">DeltaCT_1</span>
<span class="o">:</span><span class="w">      </span><span class="o">:</span>
<span class="n">time_n</span><span class="w"> </span><span class="n">pitch_n</span><span class="o">/</span><span class="n">DeltaCT_n</span>
</pre></div>
</div>
<p>Notably, the file should contain only one header line.
If <code class="docutils literal notranslate"><span class="pre">turbineModel</span></code> is set to <code class="docutils literal notranslate"><span class="pre">ALM</span></code> or <code class="docutils literal notranslate"><span class="pre">ADM</span></code>, pitch in degrees should
be provided in the second column, while for <code class="docutils literal notranslate"><span class="pre">uniformADM</span></code> and <code class="docutils literal notranslate"><span class="pre">ADM</span></code>
the second column corresponds to a delta in thrust coefficient. Whether
this is interpreted as disk based or freestream, it depends on the settings
provided in the wind turbine model file. This is a simple method to impose
a wind farm controller (in the context of wind farm wake mixing) with no
feedback action.</p>
</td>
</tr>
</tbody>
</table>
<p>As TOSCA requires individual definition of each turbine, this comes with some perks. In particular, the entires described in the
above table can be different for each wind turbine. This means that the user can use different actuator models, controller
activation and turbine model specification within the same simulation. This becomes useful for studies of multiple wind farm
clusters which might have different turbines and be controlled differently.</p>
<p>The turbine type specification is contained in a file named as the <code class="docutils literal notranslate"><span class="pre">turbineType</span></code> entry in the <code class="docutils literal notranslate"><span class="pre">windFarmProperties</span></code> file. Its
syntax is defined as follows</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp"># TOSCA Input file - Turbine Type File</span>
<span class="cp"># -------------------------------------------</span>

<span class="cp"># Global wind turbine parameters</span>
<span class="n">rTip</span><span class="w">                </span><span class="n">scalar</span>
<span class="n">rHub</span><span class="w">                </span><span class="n">scalar</span>
<span class="n">hTower</span><span class="w">              </span><span class="n">scalar</span>
<span class="n">overHang</span><span class="w">            </span><span class="n">scalar</span>
<span class="n">precone</span><span class="w">             </span><span class="n">scalar</span>
<span class="n">towerDir</span><span class="w">            </span><span class="n">vector</span>
<span class="n">rotorDir</span><span class="w">            </span><span class="n">vector</span>
<span class="n">upTilt</span><span class="w">              </span><span class="n">scalar</span>
<span class="n">initialOmega</span><span class="w">        </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for ALM and ADM only</span>
<span class="n">nBlades</span><span class="w">             </span><span class="n">integer</span><span class="w"> </span><span class="c1">// for ALM and ADM only</span>
<span class="n">rotationDir</span><span class="w">         </span><span class="n">string</span><span class="w">  </span><span class="c1">// for ALM and ADM only</span>
<span class="n">includeTower</span><span class="w">        </span><span class="kt">bool</span>
<span class="n">includeNacelle</span><span class="w">      </span><span class="kt">bool</span>
<span class="n">debug</span><span class="w">               </span><span class="kt">bool</span>

<span class="cp"># Controllers</span>
<span class="n">genControllerType</span><span class="w">   </span><span class="n">string</span><span class="w">  </span><span class="c1">// for ALM and ADM only</span>
<span class="n">pitchControllerType</span><span class="w"> </span><span class="n">string</span><span class="w">  </span><span class="c1">// for ALM and ADM only</span>
<span class="n">yawControllerType</span><span class="w">   </span><span class="n">string</span>

<span class="cp"># Actuator model parameters</span>
<span class="n">nRadPts</span><span class="w">             </span><span class="n">integer</span><span class="w"> </span><span class="c1">// for ALM, ADM and uniformADM only</span>
<span class="n">nAziPts</span><span class="w">             </span><span class="n">integer</span><span class="w"> </span><span class="c1">// for ADM and uniformADM only</span>
<span class="n">Uref</span><span class="w">                </span><span class="n">scalar</span>
<span class="n">Ct</span><span class="w">                  </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for uniformADM and AFM only</span>
<span class="n">projection</span><span class="w">          </span><span class="n">string</span><span class="w">  </span><span class="c1">// for ALM and AFM only</span>
<span class="n">sampleType</span><span class="w">          </span><span class="n">string</span><span class="w">  </span><span class="c1">// for ALM, uniformADM and AFM only</span>
<span class="n">epsilon</span><span class="w">             </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for ALM, ADM and unformADM only</span>
<span class="n">epsilon_x</span><span class="w">           </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for anisotropic AFM only</span>
<span class="n">epsilon_y</span><span class="w">           </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for anisotropic AFM only</span>
<span class="n">epsilon_z</span><span class="w">           </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for anisotropic AFM only</span>
<span class="n">gaussexp_x</span><span class="w">          </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for gaussexp AFM only</span>
<span class="n">gaussexp_r</span><span class="w">          </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for gaussexp AFM only</span>
<span class="n">gaussexp_f</span><span class="w">          </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for gaussexp AFM only</span>
<span class="n">epsilonFactor_x</span><span class="w">     </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for anisotropic ALM only</span>
<span class="n">epsilonFactor_y</span><span class="w">     </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for anisotropic ALM only</span>
<span class="n">epsilonFactor_z</span><span class="w">     </span><span class="n">scalar</span><span class="w">  </span><span class="c1">// for anisotropic ALM only</span>

<span class="cp"># Tower properties</span>
<span class="n">towerData</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Cd</span><span class="w">              </span><span class="n">scalar</span>
<span class="w">    </span><span class="n">epsilon</span><span class="w">         </span><span class="n">scalar</span>
<span class="w">    </span><span class="n">nLinPts</span><span class="w">         </span><span class="n">integer</span>
<span class="w">    </span><span class="n">rBase</span><span class="w">           </span><span class="n">scalar</span>
<span class="w">    </span><span class="n">rTop</span><span class="w">            </span><span class="n">scalar</span>
<span class="p">}</span>

<span class="cp"># Nacelle properties</span>
<span class="n">nacelleData</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Cd</span><span class="w">              </span><span class="n">scalar</span>
<span class="w">    </span><span class="n">epsilon</span><span class="w">         </span><span class="n">scalar</span>
<span class="p">}</span>

<span class="cp"># names of the foils (for ALM and ADM only)</span>
<span class="n">airfoils</span>
<span class="p">{</span>
<span class="w">    </span><span class="nl">airfoil_1</span>
<span class="w">    </span><span class="p">:</span>
<span class="w">    </span><span class="n">airfoil_n</span>
<span class="p">}</span>


<span class="cp"># Blade parameters given as:</span>
<span class="cp"># (radius(m) c(m) twist(deg) thickness(m, anisotropic ALM only) airfoilID)</span>
<span class="cp"># for ALM and ADM only</span>
<span class="n">bladeData</span>
<span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="n">scalar</span><span class="w">     </span><span class="n">scalar</span><span class="w">   </span><span class="n">scalar</span><span class="w">     </span><span class="n">integer</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="o">:</span><span class="w">          </span><span class="o">:</span><span class="w">        </span><span class="o">:</span><span class="w">          </span><span class="o">:</span><span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n">scalar</span><span class="w">     </span><span class="n">scalar</span><span class="w">   </span><span class="n">scalar</span><span class="w">     </span><span class="n">integer</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notably, depending on the chosen actuator model type, different parameters are needed. Indication about this are provided in the
above file example. Parameters which do not contain a comment line are always required. Each of the above parameters is detailed
in the table below:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 20.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>entry</strong></p></td>
<td><p><strong>entry type</strong></p></td>
<td><p><strong>description</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rTip</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rHub</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hTower</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">overHang</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">precone</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">towerDir</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rotorDir</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">upTilt</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">initialOmega</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nBlades</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rotationDir</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">includeTower</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">includeNacelle</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">debug</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">genControllerType</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pitchControllerType</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yawControllerType</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nRadPts</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nAziPts</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Uref</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Ct</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">projection</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sampleType</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">epsilon</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">epsilon_x</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">epsilon_y</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">epsilon_z</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gaussexp_x</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gaussexp_r</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gaussexp_f</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">epsilonFactor_x</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">epsilonFactor_y</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">epsilonFactor_z</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">towerData</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nacelleData</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">airfoils</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bladeData</span></code></p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="spatial-mesh">
<span id="spatial-mesh-section"></span><h2>Spatial Mesh<a class="headerlink" href="#spatial-mesh" title="Link to this heading"></a></h2>
<p>The spatial mesh can be provided in two different formats. These can be selected with the <code class="docutils literal notranslate"><span class="pre">-meshFileType</span></code> keyword in the <cite>control.dat</cite> file, which can be set to <code class="docutils literal notranslate"><span class="pre">cartesian</span></code> or <code class="docutils literal notranslate"><span class="pre">curvilinear</span></code> for <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> and <code class="docutils literal notranslate"><span class="pre">.grid</span></code> formats, respectively. While both formats describe a structured mesh (TOSCA can only operate with this type of mesh), the first one is additionally cartesian. Both types of mesh can be defined such that grid points are stretched in all spatial directions. The <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> mesh format is TOSCA’s custom Cartesian mesh format, and it is very convenient since the user only has to provide the discretization along each of the three cartesian axes. The <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> mesh file format can be generalized as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Nx<span class="w"> </span>Ny<span class="w"> </span>Nz
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">2</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">2</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">2</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
:
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk<span class="w"> </span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>y<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk<span class="w"> </span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>z<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk<span class="w"> </span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">2</span><span class="o">)</span>
:
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span>Ni<span class="o">)</span><span class="w"> </span>y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span>Ni<span class="o">)</span><span class="w"> </span>z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span>Ni<span class="o">)</span>
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">2</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">2</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">2</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
:
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span>Nj<span class="w"> </span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span>Nj<span class="w"> </span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span>Nj<span class="w"> </span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
</pre></div>
</div>
<p>which, for a cube extending 50 m in each direction, with 10 m cells along each direction (hence 6 points), is given by</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span>
<span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="m">10</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="m">20</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="m">30</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="m">40</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="m">50</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">0</span>
<span class="m">0</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">0</span>
<span class="m">0</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">0</span>
<span class="m">0</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">0</span>
<span class="m">0</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">0</span>
<span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">10</span>
<span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">20</span>
<span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">30</span>
<span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">40</span>
<span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">50</span>
</pre></div>
</div>
<p>As can be noticed, the mesh file is extremely light, even for large meshes, as only the discretization along the three cartesian axes is provided. The coordinates of the remaining mesh cells are inferred iternally within TOSCA, starting from the axes discretization.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.grid</span></code> format is a curvilinear mesh format (available for example in the meshing software <cite>Pointwise</cite>), where the cartesian coordinates of each mesh point are provided. This becomes useful when the mesh is deformed, and a unique relationship between the cartesian and curvilinear sets of coordinates does not exist anymore. This is a much heavier mesh format, which can be generalized as follows</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Nj<span class="w"> </span>Nk<span class="w"> </span>Ni
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>.....<span class="w"> </span>x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span>Nj,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
:
:
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk,j<span class="o">=</span><span class="m">1</span><span class="w"> </span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>....x<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk,j<span class="o">=</span>Nj<span class="w"> </span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>....x<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span>Nj,i<span class="o">=</span><span class="m">2</span><span class="o">)</span>
:
:
x<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk<span class="w"> </span>,j<span class="o">=</span><span class="m">1</span><span class="w"> </span>,i<span class="o">=</span>Ni<span class="o">)</span><span class="w"> </span>...x<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk<span class="w"> </span>,j<span class="o">=</span>Nj<span class="w"> </span>,i<span class="o">=</span>Ni<span class="o">)</span>
y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>.....<span class="w"> </span>y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span>Nj,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
:
:
y<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk,j<span class="o">=</span><span class="m">1</span><span class="w"> </span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>....y<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk,j<span class="o">=</span>Nj<span class="w"> </span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>....y<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span>Nj,i<span class="o">=</span><span class="m">2</span><span class="o">)</span>
:
:
y<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk<span class="w"> </span>,j<span class="o">=</span><span class="m">1</span><span class="w"> </span>,i<span class="o">=</span>Ni<span class="o">)</span><span class="w"> </span>...y<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk<span class="w"> </span>,j<span class="o">=</span>Nj<span class="w"> </span>,i<span class="o">=</span>Ni<span class="o">)</span>
z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>.....<span class="w"> </span>z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span>Nj,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
:
:
z<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk,j<span class="o">=</span><span class="m">1</span><span class="w"> </span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>....z<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk,j<span class="o">=</span>Nj<span class="w"> </span>,i<span class="o">=</span><span class="m">1</span><span class="o">)</span>
z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span><span class="m">1</span>,i<span class="o">=</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>....z<span class="o">(</span><span class="nv">k</span><span class="o">=</span><span class="m">1</span>,j<span class="o">=</span>Nj,i<span class="o">=</span><span class="m">2</span><span class="o">)</span>
:
:
z<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk<span class="w"> </span>,j<span class="o">=</span><span class="m">1</span><span class="w"> </span>,i<span class="o">=</span>Ni<span class="o">)</span><span class="w"> </span>...z<span class="o">(</span><span class="nv">k</span><span class="o">=</span>Nk<span class="w"> </span>,j<span class="o">=</span>Nj<span class="w"> </span>,i<span class="o">=</span>Ni<span class="o">)</span>
</pre></div>
</div>
<p>Taking as an example the same box extending 50 m in each direction, with 10 m cells along each direction, this can be expressed using the <code class="docutils literal notranslate"><span class="pre">.grid</span></code> format as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">30</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">40</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
<span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">50</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both in the <code class="docutils literal notranslate"><span class="pre">.grid</span></code> and <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> format, the user has to provide the <em>mesh points</em> rather then the <em>cell centers</em> coordinates.</p>
</div>
<p>Notably, every cartesian mesh can be expressed using the curvilinear format, while the opposite is not true. TOSCA always operates using curvilinear coordinates internally, and since boundary conditions are given on curvilinear patches one has to bear in mind a few concepts, explained below, in order to assign BCs in the way he intends to. Firstly, one can think of curvilinear coordinates as the mesh cell indices in each of the three directions, expressed in TOSCA as <cite>k</cite>, <cite>j</cite> and <cite>i</cite>. With this in mind, it appears clear that each boundary can be identified by keeping one of the indices fixed while the others two vary. In fact, boundaries are identifyed in TOSCA using <cite>kLeft</cite>, <cite>kRight</cite>, <cite>jLeft</cite>, <cite>jRight</cite>, <cite>iLeft</cite> and <cite>iRight</cite>. When the mesh is cartesian (and the axes are aligned to the edges of the domain) boundaries can be also identifyed with the minimum and maximum of each cartesian coordinates. However, this is not general and it would not hold for a curvilinear mesh, or even a cartesian mesh with the domain edges not aligned with the cartesian coordinates. For this reason, boundaries are always identified using the curvilinear definition in TOSCA. To know how to assign boundary conditions, e.g. what boundary corresponds to the <cite>kLeft</cite> patch and so on, one has to keep in mind that the <cite>.grid</cite> file is read by TOSCA using a <cite>i,k,j</cite> nested loop order, namely</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="c1">// loop through the mesh cells</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">Ni</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">&lt;</span><span class="n">Nk</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">Nj</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span><span class="c1">// read point k,j,i in the .grid file</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Looking at the <code class="docutils literal notranslate"><span class="pre">.grid</span></code> file format, it is clear that there is no unique relation between <cite>k,j,i</cite> and <cite>x,y,z</cite>. However, when the mesh is cartesian, this relation depends on how the mesh file is created. It is easy to notice that, in the provided <code class="docutils literal notranslate"><span class="pre">.grid</span></code> example, <cite>k,j,i</cite> correspond to <cite>x,z,y</cite>. For the <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file format, where a unique relation exists, TOSCA constructs the mesh such that <cite>k,j,i</cite> correspond to <cite>x,z,y</cite> (this can be also appreciated in the provided example). In an ABL or wind farm simulation, where x is usually aligned with the wind direction, and y and z are the spanwise and vertical coordinates, respectively, the inlet will corrispond to <cite>kLeft</cite>, the outlet to <cite>kRight</cite>, the bottom and top to <cite>jLeft</cite> and <cite>jRight</cite>, respectively, while the spanwise boundaries will be <cite>iLeft</cite> and <cite>iRight</cite>. This relation will always apply as long as a cartesian mesh is used. The relations between curvilinear and cartesian coordinates depending on the mesh and domain type are summarized in the following table.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>format</strong></p></td>
<td><p><strong>cartesian domain</strong></p></td>
<td><p><strong>curvilinear domain</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.grid</span></code></p></td>
<td><p>case-dependent</p></td>
<td><p>unique relation impossible</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.xyz</span></code></p></td>
<td><p><cite>k,j,i</cite> -&gt; <cite>x,z,y</cite></p></td>
<td><p>non-representable</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tosca_quickstart.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tosca_theory_guide.html" class="btn btn-neutral float-right" title="Theory Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sebastiano Stipa, Arjun Ajay, Joshua Brinkerhoff.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>